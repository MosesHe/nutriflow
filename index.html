<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NutriFlow - 智能营养助手</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }

        .main-wrapper {
            flex: 1;
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
        }

        .container {
            width: 100%;
            background: white;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .nav-dropdown-toggle {
            display: none;
        }

        .nav-bar {
            background: white;
            border-bottom: 1px solid #e2e8f0;
            padding: 0;
        }

        .nav-tabs {
            display: flex;
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .nav-tab {
            flex: 1;
            text-align: center;
        }

        .nav-tab button {
            width: 100%;
            padding: 20px 30px;
            border: none;
            background: none;
            font-size: 16px;
            font-weight: 600;
            color: #64748b;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }

        .nav-tab button:hover {
            background: #f8fafc;
            color: #43cea2;
        }

        .nav-tab button.active {
            color: #43cea2;
            border-bottom-color: #43cea2;
        }

        .header {
            background: linear-gradient(135deg, #43cea2 0%, #185a9d 100%);
            padding: 30px;
            text-align: center;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 300;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .search-section {
            padding: 30px;
            background: #f8fafc;
            border-bottom: 1px solid #e2e8f0;
        }

        .search-box {
            max-width: 600px;
            margin: 0 auto;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 15px 20px 15px 50px;
            font-size: 16px;
            border: 2px solid #e2e8f0;
            border-radius: 50px;
            outline: none;
            transition: all 0.3s ease;
            background: white;
        }

        .search-input:focus {
            border-color: #43cea2;
            box-shadow: 0 0 0 3px rgba(67, 206, 162, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 18px;
            top: 50%;
            transform: translateY(-50%);
            color: #64748b;
        }

        .category-nav {
            padding: 20px 30px;
            background: white;
            border-bottom: 1px solid #e2e8f0;
            overflow-x: auto;
        }

        .category-tabs {
            display: flex;
            gap: 10px;
            min-width: fit-content;
        }

        .category-tab {
            padding: 10px 20px;
            background: #f1f5f9;
            border: none;
            border-radius: 25px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .category-tab.active {
            background: #43cea2;
            color: white;
        }

        .category-tab:hover {
            background: #e2e8f0;
        }

        .category-tab.active:hover {
            background: #2ca889;
        }

        .content {
            padding: 30px;
        }

        .nutrition-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .nutrition-table thead {
            background: #43cea2;
            color: white;
        }

        .nutrition-table th {
            padding: 15px 20px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .nutrition-table tbody tr {
            border-bottom: 1px solid #f1f5f9;
            transition: all 0.3s ease;
        }

        .nutrition-table tbody tr:hover {
            background: #f8fafc;
        }

        .nutrition-table tbody tr:last-child {
            border-bottom: none;
        }

        .nutrition-table td {
            padding: 20px;
            vertical-align: top;
        }

        .food-name-cell {
            font-weight: 600;
            color: #1e293b;
            min-width: 150px;
        }

        .category-cell {
            color: #64748b;
            font-size: 14px;
            min-width: 100px;
        }

        .carb-rate-cell {
            font-weight: 700;
            color: #43cea2;
            font-size: 16px;
            min-width: 80px;
        }

        .gi-cell {
            min-width: 80px;
        }

        .description-cell {
            color: #64748b;
            line-height: 1.6;
            font-size: 14px;
            max-width: 400px;
        }

        .gi-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: inline-block;
        }

        .gi-高 {
            background: #fee2e2;
            color: #dc2626;
        }

        .gi-中 {
            background: #fef3c7;
            color: #d97706;
        }

        .gi-低 {
            background: #dcfce7;
            color: #16a34a;
        }

        .category-section {
            margin-bottom: 40px;
        }

        .category-title {
            font-size: 1.8rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #43cea2;
            display: inline-block;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #64748b;
        }

        .empty-state svg {
            width: 80px;
            height: 80px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .meal-calculator {
            display: none;
            padding: 30px;
        }

        .meal-calculator.active {
            display: block;
        }

        .daily-input-section {
            background: #f8fafc;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .input-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .input-item {
            display: flex;
            flex-direction: column;
        }

        .input-label {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 8px;
        }

        .input-field {
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .input-field:focus {
            outline: none;
            border-color: #43cea2;
        }

        .calculate-btn {
            background: #43cea2;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .calculate-btn:hover {
            background: #2ca889;
        }

        .meals-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .meal-card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .meal-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 15px;
            text-align: center;
        }

        .meal-targets {
            background: #f1f5f9;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .target-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .target-item:last-child {
            margin-bottom: 0;
        }

        .target-label {
            color: #64748b;
        }

        .target-value {
            font-weight: 600;
            color: #43cea2;
        }

        .food-selector {
            margin-bottom: 15px;
        }

        .food-select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .food-select:focus {
            outline: none;
            border-color: #43cea2;
        }

        .selected-foods {
            margin-top: 15px;
        }

        .selected-food-item {
            background: #e6f7ff;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .food-weight {
            font-weight: 600;
            color: #43cea2;
        }

        .remove-food {
            background: #ef4444;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
        }

        .add-food-btn {
            background: #43cea2;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            width: 100%;
        }

        .nutrition-summary {
            background: #f8fafc;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .page-content {
            display: none;
        }

        .page-content.active {
            display: block;
        }

        .calorie-calculator {
            padding: 30px;
        }

        .user-info-section {
            background: #f8fafc;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .info-group {
            display: flex;
            flex-direction: column;
        }

        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .results-section {
            margin-bottom: 30px;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .result-card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .result-card h3 {
            color: #64748b;
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 15px;
        }

        .result-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: #43cea2;
            line-height: 1;
        }

        .result-unit, .result-status {
            font-size: 14px;
            color: #64748b;
            margin-top: 8px;
        }

        .calorie-breakdown {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .breakdown-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 20px;
            text-align: center;
        }

        .breakdown-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f1f5f9;
        }

        .breakdown-item:last-child {
            border-bottom: none;
        }

        .breakdown-item.intake {
            font-weight: 600;
        }

        .breakdown-item.intake .breakdown-value {
            color: #0ea5e9;
            font-weight: 700;
            font-size: 1.1rem;
        }

        .breakdown-label {
            color: #64748b;
        }

        .breakdown-value {
            font-weight: 600;
            color: #43cea2;
        }

        .detailed-input-section {
            background: #f8fafc;
            padding: 25px;
            border-radius: 15px;
            margin-top: 20px;
        }

        .detailed-input-section small {
            display: block;
            color: #64748b;
            font-size: 12px;
            margin-top: 4px;
        }

        .qa-page {
            padding: 30px;
        }

        .qa-type-selector {
            background: #f8fafc;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
        }

        .qa-type-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .qa-type-btn {
            padding: 15px 30px;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #64748b;
        }

        .qa-type-btn.active {
            background: #43cea2;
            color: white;
            border-color: #43cea2;
        }

        .qa-type-btn:hover {
            border-color: #43cea2;
            color: #43cea2;
        }

        .qa-type-btn.active:hover {
            background: #2ca889;
            border-color: #2ca889;
            color: white;
        }

        .qa-section {
            display: none;
        }

        .qa-section.active {
            display: block;
        }

        .qa-item {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 15px;
            margin-bottom: 15px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }

        .qa-item:hover {
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .qa-question {
            padding: 20px 25px;
            cursor: pointer;
            font-weight: 600;
            color: #1e293b;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .qa-question:hover {
            background: #f8fafc;
            color: #43cea2;
        }

        .qa-toggle-icon {
            font-size: 20px;
            transition: transform 0.3s ease;
            color: #64748b;
        }

        .qa-item.expanded .qa-toggle-icon {
            transform: rotate(180deg);
        }

        .qa-answer {
            padding: 0 25px 25px 25px;
            color: #64748b;
            line-height: 1.8;
            border-top: 1px solid #f1f5f9;
            display: none;
        }

        .qa-answer p {
            margin: 0 0 1.2em 0;
        }

        .qa-answer p:last-child {
            margin-bottom: 0;
        }

        .qa-item.expanded .qa-answer {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .copyright {
            background: transparent;
            border: none;
            padding: 20px 30px;
            text-align: center;
            color: #64748b;
            font-size: 14px;
            margin-top: 20px;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }

        .copyright p {
            margin-bottom: 10px;
        }

        .copyright p:last-child {
            margin-bottom: 0;
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .nav-bar {
                position: relative;
            }

            .nav-tabs {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: white;
                border: 1px solid #e2e8f0;
                border-top: none;
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                z-index: 1000;
                flex-direction: column;
            }

            .nav-tabs.show {
                display: flex;
            }

            .nav-dropdown-toggle {
                display: block;
                width: 100%;
                padding: 15px 20px;
                background: white;
                border: none;
                border-bottom: 1px solid #e2e8f0;
                font-size: 16px;
                font-weight: 600;
                color: #43cea2;
                text-align: left;
                cursor: pointer;
                position: relative;
            }

            .nav-dropdown-toggle::after {
                content: '▼';
                position: absolute;
                right: 20px;
                top: 50%;
                transform: translateY(-50%);
                transition: transform 0.3s ease;
            }

            .nav-dropdown-toggle.active::after {
                transform: translateY(-50%) rotate(180deg);
            }

            .nav-tab {
                border-bottom: 1px solid #f1f5f9;
            }

            .nav-tab:last-child {
                border-bottom: none;
            }

            .nav-tab button {
                width: 100%;
                padding: 15px 20px;
                text-align: left;
                border-bottom: none;
            }

            .header h1 {
                font-size: 2rem;
            }

            /* 移动端表格优化 */
            .nutrition-table {
                font-size: 12px;
                display: block;
                overflow-x: auto;
                white-space: nowrap;
                -webkit-overflow-scrolling: touch;
            }

            .nutrition-table thead,
            .nutrition-table tbody,
            .nutrition-table tr {
                display: table;
                width: 100%;
                table-layout: fixed;
            }

            .nutrition-table thead {
                width: calc(100% - 1em);
            }

            .nutrition-table th,
            .nutrition-table td {
                padding: 8px 4px;
                font-size: 11px;
                word-wrap: break-word;
                overflow: hidden;
                text-overflow: ellipsis;
            }

            .category-cell {
                min-width: 60px;
                width: 15%;
            }

            .food-name-cell {
                min-width: 80px;
                width: 20%;
            }

            .carb-rate-cell {
                min-width: 60px;
                width: 15%;
            }

            .gi-cell {
                min-width: 50px;
                width: 12%;
            }

            .description-cell {
                min-width: 120px;
                width: 38%;
                max-width: none;
                white-space: normal;
                line-height: 1.3;
            }

            /* 表格容器添加滚动提示 */
            .content {
                padding: 20px 15px;
            }

            .nutrition-container::before {
                content: "← 左右滑动查看更多内容 →";
                display: block;
                text-align: center;
                color: #64748b;
                font-size: 12px;
                margin-bottom: 10px;
                padding: 8px;
                background: #f8fafc;
                border-radius: 4px;
                border: 1px solid #e2e8f0;
            }

            .info-grid {
                grid-template-columns: 1fr;
            }

            .results-grid {
                grid-template-columns: 1fr;
            }

            .copyright {
                margin-top: 10px;
                padding: 15px 20px;
            }
        }
    </style>
</head>
<body>
    <div class="main-wrapper">
        <div class="container">
        <div class="nav-bar">
            <button class="nav-dropdown-toggle" onclick="toggleMobileNav()">热量计算器</button>
            <ul class="nav-tabs">
                <li class="nav-tab">
                    <button class="nav-btn active" data-page="calorie">热量计算器</button>
                </li>
                <li class="nav-tab">
                    <button class="nav-btn" data-page="calculator">三餐摄入计算</button>
                </li>
                <li class="nav-tab">
                    <button class="nav-btn" data-page="nutrition">营养成分表</button>
                </li>
                <li class="nav-tab">
                    <button class="nav-btn" data-page="qa">Q&A答疑</button>
                </li>
            </ul>
        </div>

        <!-- 营养成分表页面 -->
        <div class="page-content" id="nutrition-page">
            <div class="header">
                <h1>NutriFlow</h1>
                <p>智能营养助手 - 营养成分表</p>
            </div>

            <div class="search-section">
                <div class="search-box">
                    <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="M21 21L16.65 16.65"></path>
                    </svg>
                    <input type="text" class="search-input" placeholder="搜索食物..." id="searchInput">
                </div>
            </div>

            <div class="category-nav">
                <div class="category-tabs" id="categoryTabs">
                    <button class="category-tab active" data-category="all">全部</button>
                </div>
            </div>

            <div class="content" id="content">
                <div class="nutrition-container" id="nutritionContainer">
                </div>
            </div>
        </div>

        <!-- 三餐摄入计算页面 -->
        <div class="page-content" id="calculator-page">
            <div class="header">
                <h1>NutriFlow</h1>
                <p>智能营养助手 - 三餐摄入计算</p>
            </div>
            
            <div class="meal-calculator">
                <div class="daily-input-section">
                    <h3 style="margin-bottom: 20px; color: #1e293b;">每日营养需求</h3>
                    <div class="input-group">
                        <div class="input-item">
                            <label class="input-label">碳水化合物总量 (克)</label>
                            <input type="number" class="input-field" id="dailyCarbs" placeholder="例如：300">
                        </div>
                        <div class="input-item">
                            <label class="input-label">蛋白质总量 (克)</label>
                            <input type="number" class="input-field" id="dailyProtein" placeholder="例如：120">
                        </div>
                    </div>
                    <button class="calculate-btn" onclick="calculateMealTargets()">计算每餐目标</button>
                </div>

                <div class="meals-grid" id="mealsGrid" style="display: none;">
                    <!-- 早餐 -->
                    <div class="meal-card">
                        <h3 class="meal-title">🌅 早餐</h3>
                        <div class="meal-targets" id="breakfast-targets">
                            <div class="target-item">
                                <span class="target-label">碳水化合物:</span>
                                <span class="target-value" id="breakfast-carbs">0g</span>
                            </div>
                            <div class="target-item">
                                <span class="target-label">蛋白质:</span>
                                <span class="target-value" id="breakfast-protein">0g</span>
                            </div>
                        </div>
                        <div class="food-selector">
                            <select class="food-select" id="breakfast-food-select">
                                <option value="">选择食物</option>
                            </select>
                            <button class="add-food-btn" onclick="addFoodToMeal('breakfast')">添加食物</button>
                        </div>
                        <div class="selected-foods" id="breakfast-foods"></div>
                        <div class="nutrition-summary" id="breakfast-summary">
                            <div class="summary-item">
                                <span>当前碳水:</span>
                                <span id="breakfast-current-carbs">0g</span>
                            </div>
                            <div class="summary-item">
                                <span>当前蛋白质:</span>
                                <span id="breakfast-current-protein">0g</span>
                            </div>
                        </div>
                    </div>

                    <!-- 午餐 -->
                    <div class="meal-card">
                        <h3 class="meal-title">🌞 午餐</h3>
                        <div class="meal-targets" id="lunch-targets">
                            <div class="target-item">
                                <span class="target-label">碳水化合物:</span>
                                <span class="target-value" id="lunch-carbs">0g</span>
                            </div>
                            <div class="target-item">
                                <span class="target-label">蛋白质:</span>
                                <span class="target-value" id="lunch-protein">0g</span>
                            </div>
                        </div>
                        <div class="food-selector">
                            <select class="food-select" id="lunch-food-select">
                                <option value="">选择食物</option>
                            </select>
                            <button class="add-food-btn" onclick="addFoodToMeal('lunch')">添加食物</button>
                        </div>
                        <div class="selected-foods" id="lunch-foods"></div>
                        <div class="nutrition-summary" id="lunch-summary">
                            <div class="summary-item">
                                <span>当前碳水:</span>
                                <span id="lunch-current-carbs">0g</span>
                            </div>
                            <div class="summary-item">
                                <span>当前蛋白质:</span>
                                <span id="lunch-current-protein">0g</span>
                            </div>
                        </div>
                    </div>

                    <!-- 晚餐 -->
                    <div class="meal-card">
                        <h3 class="meal-title">🌙 晚餐</h3>
                        <div class="meal-targets" id="dinner-targets">
                            <div class="target-item">
                                <span class="target-label">碳水化合物:</span>
                                <span class="target-value" id="dinner-carbs">0g</span>
                            </div>
                            <div class="target-item">
                                <span class="target-label">蛋白质:</span>
                                <span class="target-value" id="dinner-protein">0g</span>
                            </div>
                        </div>
                        <div class="food-selector">
                            <select class="food-select" id="dinner-food-select">
                                <option value="">选择食物</option>
                            </select>
                            <button class="add-food-btn" onclick="addFoodToMeal('dinner')">添加食物</button>
                        </div>
                        <div class="selected-foods" id="dinner-foods"></div>
                        <div class="nutrition-summary" id="dinner-summary">
                            <div class="summary-item">
                                <span>当前碳水:</span>
                                <span id="dinner-current-carbs">0g</span>
                            </div>
                            <div class="summary-item">
                                <span>当前蛋白质:</span>
                                <span id="dinner-current-protein">0g</span>
                            </div>
                        </div>
                    </div>

                    <!-- 零食/夜宵 -->
                    <div class="meal-card">
                        <h3 class="meal-title">🍪 零食/夜宵</h3>
                        <div class="meal-targets" id="snack-targets">
                            <div class="target-item">
                                <span class="target-label">碳水化合物:</span>
                                <span class="target-value" id="snack-carbs">0g</span>
                            </div>
                            <div class="target-item">
                                <span class="target-label">蛋白质:</span>
                                <span class="target-value" id="snack-protein">0g</span>
                            </div>
                        </div>
                        <div class="food-selector">
                            <select class="food-select" id="snack-food-select">
                                <option value="">选择食物</option>
                            </select>
                            <button class="add-food-btn" onclick="addFoodToMeal('snack')">添加食物</button>
                        </div>
                        <div class="selected-foods" id="snack-foods"></div>
                        <div class="nutrition-summary" id="snack-summary">
                            <div class="summary-item">
                                <span>当前碳水:</span>
                                <span id="snack-current-carbs">0g</span>
                            </div>
                            <div class="summary-item">
                                <span>当前蛋白质:</span>
                                <span id="snack-current-protein">0g</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Q&A答疑页面 -->
        <div class="page-content" id="qa-page">
            <div class="header">
                <h1>NutriFlow</h1>
                <p>智能营养助手 - Q&A答疑</p>
            </div>
            
            <div class="qa-page">
                <div class="qa-type-selector">
                    <h3 style="margin-bottom: 20px; color: #1e293b;">选择问答类型</h3>
                    <div class="qa-type-buttons">
                        <button class="qa-type-btn active" data-type="cut">减脂Q&A</button>
                        <button class="qa-type-btn" data-type="bulk">增肌Q&A</button>
                    </div>
                </div>

                <div class="qa-section active" id="cut-qa">
                    <!-- 减脂Q&A内容将在这里动态生成 -->
                </div>

                <div class="qa-section" id="bulk-qa">
                    <!-- 增肌Q&A内容将在这里动态生成 -->
                </div>
            </div>
        </div>

        <!-- 热量计算器页面 -->
        <div class="page-content active" id="calorie-page">
            <div class="header">
                <h1>NutriFlow</h1>
                <p>智能营养助手 - 热量计算器</p>
            </div>
            
            <div class="calorie-calculator">
                <div class="user-info-section">
                    <h3 style="margin-bottom: 20px; color: #1e293b;">基本信息</h3>
                    <div class="info-grid">
                        <div class="info-group">
                            <label class="input-label">性别</label>
                            <select class="input-field" id="gender">
                                <option value="">请选择</option>
                                <option value="male">男性</option>
                                <option value="female">女性</option>
                            </select>
                        </div>
                        <div class="info-group">
                            <label class="input-label">年龄</label>
                            <input type="number" class="input-field" id="age" placeholder="例如：25">
                        </div>
                        <div class="info-group">
                            <label class="input-label">身高 (cm)</label>
                            <input type="number" class="input-field" id="height" placeholder="例如：170">
                        </div>
                        <div class="info-group">
                            <label class="input-label">体重 (kg)</label>
                            <input type="number" class="input-field" id="weight" placeholder="例如：70">
                        </div>
                        <div class="info-group">
                            <label class="input-label">目标</label>
                            <select class="input-field" id="goal">
                                <option value="">请选择</option>
                                <option value="bulk">增肌</option>
                                <option value="cut-no-training">减脂（无力量训练）</option>
                                <option value="cut-with-training">减脂（有力量训练）</option>
                            </select>
                        </div>
                        <div class="info-group">
                            <label class="input-label">有氧训练消耗 (大卡/天)</label>
                            <input type="number" class="input-field" id="cardioConsumption" placeholder="例如：200" value="0">
                            <small style="color: #64748b; font-size: 12px; margin-top: 4px;">根据有氧运动强度和时长估算</small>
                        </div>
                        <div class="info-group">
                            <label class="input-label">力量训练水平</label>
                            <select class="input-field" id="strengthLevel">
                                <option value="">请选择力量训练水平</option>
                                <option value="beginner">新手</option>
                                <option value="intermediate">有基础</option>
                                <option value="advanced">老手</option>
                            </select>
                            <small style="color: #64748b; font-size: 12px; margin-top: 4px;">仅对有力量训练的目标有效</small>
                        </div>
                    </div>
                    <button class="calculate-btn" onclick="calculateCalories()" style="margin-top: 20px;">计算热量需求</button>
                </div>

                <div class="results-section" id="calorieResults" style="display: none;">
                    <div class="results-grid">
                        <div class="result-card">
                            <h3>BMI指数</h3>
                            <div class="result-value" id="bmiValue">0</div>
                            <div class="result-status" id="bmiStatus">-</div>
                        </div>
                        <div class="result-card">
                            <h3>基础代谢</h3>
                            <div class="result-value" id="bmrValue">0</div>
                            <div class="result-unit">大卡/天</div>
                        </div>
                    </div>

                    <div class="calorie-breakdown" id="calorieBreakdown">
                        <!-- 热量分解详情将在这里显示 -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="copyright">
        <p>&copy; 2025 NutriFlow - 智能营养助手. All rights reserved.</p>
        <p>数据来源于科学营养研究，仅供参考，请根据个人情况合理调整</p>
    </div>

    <script>
        let nutritionData = [
            {category: "米类主食", food: "生米", carbohydrate: "75%", gi: "高", description: "大米、糙米、糯米、小米、黑米、紫米等不分品种均是"},
            {category: "米类主食", food: "米饭（很软）", carbohydrate: "25%", gi: "高", description: "只有自己做饭才可能这么软，外食几乎不可能"},
            {category: "米类主食", food: "米饭（一般）", carbohydrate: "30%", gi: "高", description: "外食的一般米饭，长方形的标准外卖盒一般100-120g碳水/盒"},
            {category: "米类主食", food: "米饭（偏硬）", carbohydrate: "35%", gi: "高", description: "外食的一般米饭，长方形的标准外卖盒一般100-120g碳水/盒"},
            {category: "米类主食", food: "米粥（稀）", carbohydrate: "10%", gi: "高", description: "粘稠度类似小米粥的稀饭"},
            {category: "米类主食", food: "米粥（一般）", carbohydrate: "13%", gi: "高", description: "粘稠度比小米粥要稠的稀饭"},
            {category: "米类主食", food: "米线（熟）", carbohydrate: "33%", gi: "高", description: "米线饱腹感很低，外食一般不低于100g碳水/份"},
            {category: "米类主食", food: "米糊（生）", carbohydrate: "75%", gi: "高", description: '电商搜索"营养米粉"或"成人米粉"或"健身米糊"，不要买成昂贵的婴儿米粉'},
            {category: "米类主食", food: "肠粉（熟）", carbohydrate: "20%", gi: "高", description: "广东地方主食，一般50-70g碳水/份"},
            {category: "米类主食", food: "粽子", carbohydrate: "50%", gi: "高", description: "可吃白粽、豆沙粽，不吃肉粽，饱腹感很低，一般40-60g碳水/个"},
            
            {category: "麦类主食", food: "切片面包", carbohydrate: "50%", gi: "高", description: "普通切片面包的脂肪率低于8%（性质是碳水食物），花式面包脂肪率高于10%甚至15%（性质是轻度糖油混合物）"},
            {category: "麦类主食", food: "馒头/花卷/馍/馕", carbohydrate: "50%", gi: "高", description: ""},
            {category: "麦类主食", food: "挂面（生）", carbohydrate: "75%", gi: "中", description: "挂面是面条里少有的中等GI碳水，不建议用于练后餐"},
            {category: "麦类主食", food: "意面（生）", carbohydrate: "75%", gi: "低", description: "意面是面条里少有的低GI碳水，不能用于练后餐"},
            {category: "麦类主食", food: "鲜面（生）", carbohydrate: "60%", gi: "高", description: "鲜面，指现和现拉的未下锅的面条，含水量高于干面，因此碳水率稍低，外食一般不低于100g碳水/份"},
            {category: "麦类主食", food: "凉面（熟）", carbohydrate: "30%", gi: "高", description: ""},
            {category: "麦类主食", food: "粗面（熟）", carbohydrate: "30%", gi: "高", description: "粗面，指像凉面粗细的面条，吸水率比细面低一些，因此碳水率稍高一些，外食一般不低于100g碳水/份"},
            {category: "麦类主食", food: "意面（熟）", carbohydrate: "30%", gi: "低", description: "意面是面条里少有的低GI碳水，不能用于练后餐"},
            {category: "麦类主食", food: "细面（熟）", carbohydrate: "23%", gi: "高", description: "细面，指像挂面粗细的面条，吸水率比粗面高一些，因此碳水率稍低一些，外食一般不低于100g碳水/份"},
            {category: "麦类主食", food: "卷饼/烙饼/馕（熟）", carbohydrate: "50%", gi: "高", description: "面粉糊烤熟成饼状主食，各地域称呼不同，饱腹感很低，外食一般不低于100g碳水/份"},
            
            {category: "其他主食", food: "红薯（生/蒸煮）", carbohydrate: "18%", gi: "高", description: ""},
            {category: "其他主食", food: "红薯（烤）", carbohydrate: "23%", gi: "高", description: ""},
            {category: "其他主食", food: "土豆（生/蒸煮）", carbohydrate: "18%", gi: "中", description: ""},
            {category: "其他主食", food: "土豆（烤）", carbohydrate: "23%", gi: "高", description: ""},
            {category: "其他主食", food: "红薯/土豆粉丝（生）", carbohydrate: "84%", gi: "低", description: "晒干制成的粉丝是少有的低GI碳水，例如酸辣粉、红薯粉、土豆粉，但注意米粉米线等新鲜食品不属于此类"},
            {category: "其他主食", food: "甜玉米（生/蒸煮）", carbohydrate: "20%", gi: "中", description: '甜玉米，指传统玉米，碳水率和GI比糯玉米低不少，不建议用于练后餐，电商关键词"笨玉米"、"老式玉米"'},
            {category: "其他主食", food: "糯玉米（生/蒸煮）", carbohydrate: "35%", gi: "高", description: '糯玉米，口味软糯，香味很重，碳水率和GI比甜玉米高得多，电商关键词"糯玉米"'},
            {category: "其他主食", food: "贝贝南瓜", carbohydrate: "21%", gi: "中", description: "注意贝贝南瓜和传统南瓜的碳水率差别极大"},
            {category: "其他主食", food: "传统南瓜", carbohydrate: "5%", gi: "中", description: "注意贝贝南瓜和传统南瓜的碳水率差别极大"},
            {category: "其他主食", food: "山药（生/蒸煮）", carbohydrate: "12%", gi: "中", description: ""},
            {category: "其他主食", food: "藕粉（生）", carbohydrate: "90%", gi: "低", description: "少有的低GI碳水，不要用于练后碳水，必须用开水冲调，冷却费时"},
            {category: "其他主食", food: "燕麦麸皮（生）", carbohydrate: "45%", gi: "低", description: "少有的低GI碳水，不要用于练后碳水；饱腹感极强；极高膳食纤维"},
            {category: "其他主食", food: "速食燕麦片（生）", carbohydrate: "60%", gi: "高", description: "饱腹感极强，一般不用于练后碳水以免太撑；极高膳食纤维"},
            {category: "其他主食", food: "速食黑麦片（生）", carbohydrate: "60%", gi: "高", description: "饱腹感极强，一般不用于练后碳水以免太撑；脂肪率比燕麦片低不少，是很纯净的碳水；极高膳食纤维"},
            
            {category: "方便食品", food: "五谷道场方便面", carbohydrate: "65%", gi: "中", description: "碳水约50g/袋或盒，虽然料包有油，但面饼非油炸，所以是碳水食物；高钠，建议粉包减半"},
            {category: "方便食品", food: "辛拉面（普通版）", carbohydrate: "65%", gi: "中", description: "碳水约50g/袋或盒，虽然面饼油炸，但调料包无油，所以接近于碳水食物；高钠，建议粉包减半"},
            {category: "方便食品", food: "辛拉面（空空面版）", carbohydrate: "65%", gi: "中", description: "碳水约50g/袋或盒，调料包无油，面饼非油炸，所以是彻底的碳水食物；高钠，建议粉包减半"},
            {category: "方便食品", food: "康力快熟意大利面", carbohydrate: "32%", gi: "低", description: "碳水约60g/袋，需另购意大利面酱料，注意意面是少有的低GI碳水，不要用于练后碳水"},
            {category: "方便食品", food: "白家陈记酸辣粉丝", carbohydrate: "60%", gi: "低", description: "碳水约40g/袋 60g/盒，料包只有几克油，所以是碳水食物；低GI，不用于练后碳水；高钠，建议粉包减半"},
            
            {category: "便携碳水", food: "切片面包", carbohydrate: "50%", gi: "高", description: "常规切片面包的脂肪率低于8%（碳水食物），花式面包脂肪率高于15%（轻度的糖油混合物）"},
            {category: "便携碳水", food: "旺仔小馒头（46g装）", carbohydrate: "88%", gi: "高", description: "碳水37g/袋，便于配餐，但约有1/4是蔗糖，不宜经常作为练后餐（可能导致果糖摄入超标）"},
            {category: "便携碳水", food: "旺仔QQ糖", carbohydrate: "72%", gi: "高", description: "小包装是20g装，碳水15g/袋；大包装是70g装，碳水50g/袋"},
            {category: "便携碳水", food: "十月稻田饭团", carbohydrate: "25%", gi: "高", description: '搜索"十月稻田糙米饭团"，碳水25g/袋，开袋即食'},
            {category: "便携碳水", food: "红螺牌驴打滚", carbohydrate: "86%", gi: "高", description: '搜索"红螺驴打滚"，碳水10g/小袋，此品牌甜味剂是用的麦芽糖而非蔗糖/果葡糖浆，不会产生果糖超标问题'},
            {category: "便携碳水", food: "山西烤馍", carbohydrate: "70%", gi: "高", description: '搜索"山西纯碱烤馍"，大袋装但保质期很长，口味类似葱香饼干'},
            {category: "便携碳水", food: "非油炸干脆面", carbohydrate: "75%", gi: "中", description: '搜索"豫派非油炸干脆面"，碳水27g/袋，口味类似小浣熊等油炸干脆面'},
            {category: "便携碳水", food: "BHB熟板栗", carbohydrate: "35%", gi: "中", description: '搜索"BHB板栗"，碳水35g/袋'},
            {category: "便携碳水", food: "沈大成豆沙青团", carbohydrate: "65%", gi: "高", description: '搜索"沈大成豆沙青团"，碳水45g/个，注意只能是豆沙味的，其他口味脂肪太高'},
            {category: "便携碳水", food: "云片糕/桃片", carbohydrate: "80%", gi: "高", description: "一般是小袋装，自己看包装重量，蔗糖率约10%，不致于导致果糖摄入超标"},
            {category: "便携碳水", food: "米花糖", carbohydrate: "85%", gi: "高", description: "一般都小袋装，自己看包装重量，蔗糖率约10%，不致于导致果糖摄入超标"},
            {category: "便携碳水", food: "娃哈哈八宝粥", carbohydrate: "13%", gi: "高", description: '搜索"娃哈哈八宝粥"，碳水47g/罐'},
            {category: "便携碳水", food: "宝矿力运动饮料", carbohydrate: "6%", gi: "中", description: "30g蔗糖/瓶，不能作为练后全部碳水，升血糖和胰岛素能力较弱，且可能导致果糖摄入超标"},
            {category: "便携碳水", food: "脉动运动饮料", carbohydrate: "5%", gi: "中", description: "30g蔗糖/瓶，不能作为练后全部碳水，升血糖和胰岛素能力较弱，且可能导致果糖摄入超标"},
            
            {category: "水果", food: "干枣", carbohydrate: "50%", gi: "中", description: ""},
            {category: "水果", food: "鲜枣", carbohydrate: "30%", gi: "中", description: ""},
            {category: "水果", food: "椰肉", carbohydrate: "30%", gi: "中", description: ""},
            {category: "水果", food: "榴莲", carbohydrate: "28%", gi: "中", description: ""},
            {category: "水果", food: "菠萝蜜", carbohydrate: "26%", gi: "中", description: ""},
            {category: "水果", food: "香蕉", carbohydrate: "22%", gi: "中", description: ""},
            {category: "水果", food: "提子", carbohydrate: "17%", gi: "中", description: ""},
            {category: "水果", food: "荔枝", carbohydrate: "17%", gi: "中", description: ""},
            {category: "水果", food: "桂圆", carbohydrate: "17%", gi: "中", description: ""},
            {category: "水果", food: "猕猴桃", carbohydrate: "15%", gi: "中", description: ""},
            {category: "水果", food: "苹果", carbohydrate: "13%", gi: "低", description: ""},
            {category: "水果", food: "梨", carbohydrate: "13%", gi: "低", description: ""},
            {category: "水果", food: "车厘子", carbohydrate: "13%", gi: "低", description: ""},
            {category: "水果", food: "火龙果", carbohydrate: "13%", gi: "中", description: ""},
            {category: "水果", food: "芒果", carbohydrate: "13%", gi: "中", description: ""},
            {category: "水果", food: "桑葚", carbohydrate: "13%", gi: "低", description: ""},
            {category: "水果", food: "葡萄", carbohydrate: "12%", gi: "低", description: ""},
            {category: "水果", food: "橘子", carbohydrate: "12%", gi: "低", description: ""},
            {category: "水果", food: "橙子", carbohydrate: "11%", gi: "低", description: ""},
            {category: "水果", food: "桃", carbohydrate: "10%", gi: "低", description: ""},
            {category: "水果", food: "柚子", carbohydrate: "10%", gi: "低", description: ""},
            {category: "水果", food: "樱桃", carbohydrate: "10%", gi: "低", description: ""},
            {category: "水果", food: "西梅", carbohydrate: "10%", gi: "低", description: ""},
            {category: "水果", food: "枇杷", carbohydrate: "9%", gi: "低", description: ""},
            {category: "水果", food: "李子", carbohydrate: "9%", gi: "低", description: ""},
            {category: "水果", food: "杏", carbohydrate: "9%", gi: "低", description: ""},
            {category: "水果", food: "哈密瓜", carbohydrate: "8%", gi: "高", description: ""},
            {category: "水果", food: "西瓜", carbohydrate: "7%", gi: "高", description: ""},
            {category: "水果", food: "木瓜", carbohydrate: "7%", gi: "中", description: ""},
            {category: "水果", food: "圣女果（小番茄）", carbohydrate: "6%", gi: "低", description: ""},
            {category: "水果", food: "西红柿（大番茄）", carbohydrate: "3%", gi: "低", description: ""},
            
            {category: "干净蛋白质", food: "瘦肉（鱼虾生肉）", carbohydrate: "15%", gi: "", description: "一般鱼虾的含水率高于家禽家畜，因此蛋白质率稍低"},
            {category: "干净蛋白质", food: "瘦肉（三文鱼/金枪鱼）", carbohydrate: "20%", gi: "", description: "三文鱼/金枪鱼本身脂肪率较高，并非瘦肉；但如果是吃中腩或赤身，且是无油生食，则也可视为瘦肉性质"},
            {category: "干净蛋白质", food: "瘦肉（家禽家畜生肉）", carbohydrate: "20%", gi: "", description: "没有白色脂肪层的猪牛羊肉，去皮的鸡鸭肉，才是瘦肉性质"},
            {category: "干净蛋白质", food: "瘦肉（一般的熟肉）", carbohydrate: "25%", gi: "", description: "鱼虾和家禽家畜瘦肉均属之，不用区分品种（鱼虾因为含水率更高，熟后脱水率更高，蛋白质率会显著上升）"},
            {category: "干净蛋白质", food: "瘦肉（柴感的熟肉）", carbohydrate: "30%", gi: "", description: "酱牛肉、干柴的卤肉等，因为脱水率更高，蛋白质率继续升高"},
            {category: "干净蛋白质", food: "瘦肉干", carbohydrate: "40%", gi: "", description: "牛肉干、鸡肉干，因为脱水率很高，蛋白质率就很高，建议碳水率（糖率）低于10%，好吃的肉干一般高于30%"},
            {category: "干净蛋白质", food: "蛋白粉", carbohydrate: "75%", gi: "", description: "乳清蛋白粉的一般70-80%，分离乳清蛋白粉一般80-90%，素食者可用大豆分离蛋白粉（氨基酸比例良好）"},
            
            {category: "含有蛋白质的混合物", food: "鸡蛋", carbohydrate: "6g/个", gi: "", description: "蛋清（蛋白质3g 脂肪0g）+蛋黄（蛋白质3g 脂肪5g）=全蛋（蛋白质6g 脂肪5g）"},
            {category: "含有蛋白质的混合物", food: "牛奶", carbohydrate: "10g/250ml盒", gi: "", description: "250ml盒装纯牛奶（碳水12g 蛋白质10g 脂肪9g），可以简单记忆为碳蛋脂都是10g"},
            {category: "含有蛋白质的混合物", food: "酸奶", carbohydrate: "10g/200ml盒", gi: "", description: "代糖酸奶可简单等同于纯牛奶，特殊酸奶（含糖酸奶会多10g+糖，希腊酸奶近乎零脂）可参照营养表来计算"},
            {category: "含有蛋白质的混合物", food: "干黄豆", carbohydrate: "35%", gi: "", description: "碳水34% 蛋白质35% 脂肪16%，碰到了可以吃一些，但不能替代瘦肉，因为氨基酸比例较差，且附带过多脂肪"},
            {category: "含有蛋白质的混合物", food: "鲜黄豆/毛豆/青豆", carbohydrate: "13%", gi: "", description: "碳水11% 蛋白质13% 脂肪5%，碰到了可以吃一些，但不能替代瘦肉，因为氨基酸比例较差，且附带过多脂肪"},
            {category: "含有蛋白质的混合物", food: "豆皮/千张", carbohydrate: "35%", gi: "", description: "碳水20% 蛋白质35% 脂肪20%，碰到了可以吃一些，但不能替代瘦肉，因为氨基酸比例较差，且附带过多脂肪"},
            {category: "含有蛋白质的混合物", food: "豆腐", carbohydrate: "7%", gi: "", description: "碳水3% 蛋白质7% 脂肪5%，碰到了可以吃一些，但不能替代瘦肉，因为氨基酸比例较差，且附带过多脂肪"},
            {category: "含有蛋白质的混合物", food: "豆浆", carbohydrate: "3%", gi: "", description: "碳水1% 蛋白质3% 脂肪2%，热量很低，可忽略不计，但肯麦等快餐店的高甜豆浆约放了20g糖，其实是一杯糖水"}
        ];
        let currentCategory = 'all';
        let searchQuery = '';
        let mealPlans = {
            breakfast: { foods: [], targetCarbs: 0, targetProtein: 0 },
            lunch: { foods: [], targetCarbs: 0, targetProtein: 0 },
            dinner: { foods: [], targetCarbs: 0, targetProtein: 0 },
            snack: { foods: [], targetCarbs: 0, targetProtein: 0 }
        };

        // 减脂Q&A数据
        let cutQAData = [
            { question: "执行了2周但体重不掉该怎么调整？", answer: `表格设计的热量缺口已比较大了，如果体重2周不掉，首先要怀疑的不是表格设计的问题，而是表格执行的问题。常见的不能执行表格的原因：

①饮食初期不定量。出于各种原因（偷懒/不重视/觉得丢面子/在外就餐不方便等），初期对食物不定量，而是以"吃到八分饱"、"荤素搭配"、"正常吃"之类的模糊标准去配餐。

②用薄荷等饮食app错误记录食物。强烈建议不要自己用薄荷等饮食app去计算，内置数据有大量是错的。

③脂肪摄入过量。要么不时吃高脂肉，要么是不时吃糖油混合物。

④方案里要做有氧但实际少做没做。

⑤常吃水果但不置换主食。

确认不存在上述问题后，才考虑是热量缺口不足的问题，办法是：a.要么每天比原食谱少吃200大卡 b.要么每周多做1000大卡有氧。` },
            { question: "减脂到多少体重就应该停止了？", answer: `建议男性BMI22-23、女性BMI20-21就停止减脂（BMI=体重kg÷身高m÷身高m）。

肌肉量一般的普通人，切勿追求低体脂（腹肌、马甲线、肚子无赘肉）。腰腹是人体脂肪层天然最厚的地方，如果你把这些部位的脂肪层清除了，但此时你上下肢其他部位就更没脂肪了。问题是，你的皮肤之下又没有足够肌肉量支撑，脂肪层没了后就成了类似皮包骨的身材。

大家在网上看到的低体脂好身材，不是单纯的低体脂，而是低体脂+高肌肉，才能呈现的视觉效果。` },
            { question: "为什么新手初期要定量饮食？", answer: `因为新手对日常食物的碳蛋脂量没有概念，按感觉吃饭大概率会导致碳蛋脂的总量严重错误。如果按感觉吃饭能八九不离十，那大家也不会有减肥问题了。我已经帮你把食物重量算好，食物品种也覆盖了日常大部分食物，你要做的唯一事情就是买个食物称，在初期（用几天到一周的时间）做定量饮食。建立饮食习惯后就不需要定量饮食了。` },
            { question: "难道要一直称重吃饭？食物是生重还是熟重？", answer: `不要理解成一直天天顿顿用食物称来称重，而是初期把你经常性食物测一下就行了：

①碳水很好定量，米饭/馒头等主食的重量是大体固定的；
②蛋白质的定量，早饭鸡蛋牛奶按数量论很简单，午饭晚饭瘦肉需要称重几次培养对瘦肉体积的认识；
③脂肪则不用定量，就用表格里的脂肪摄入推荐模式。

生熟问题：米饭、面条的生熟重量差别很大，所以表格里生熟重量都写了，一定要分清。` },
            { question: "是否有一些固定重量的食物？", answer: `大部分食物不是全国统一重量的，仍需自己定量，比较固定重量的食物只有以下这些：

【外卖米饭（长方形盒）】碳水100g/盒
【吐司切片面包】碳水25g/片
【鸡翅根（去皮）】蛋白质8g/个
【小鸡腿（去皮）】蛋白质15g/个
【全鸡腿（去皮）】蛋白质40g/个
【苹果/橙子/香蕉】碳水20-30g/个` },
            { question: "表格里哪些食物如果不定量会被严重错估？", answer: `【面条/米线/卷饼】容易被低估碳水量。这些是饱腹感最低的主食，减脂一般不作为常规主食，一份的碳水量高达80-160g。

【菜肴的瘦肉量】容易被高估蛋白质。食堂外卖餐馆的一人份瘦肉菜肴，瘦肉量一般很难超过100g（蛋白质25g）。

【个别特殊菜肴】容易被低估脂肪量。需要回避：炒鸡蛋、炒茄子、油炸菜等。` },
            { question: "哪些食物需要特别提醒？", answer: `【瘦肉】减脂期的肉类要严格确保是瘦肉，瘦肉的脂肪率一般低于5%。

【高脂肉】鸡鸭皮、大排、糖醋里脊、锅包肉、鸡翅、猪蹄等。这些都不是瘦肉，脂肪率一般都不低于10%，不能作为减脂期的日常食物。

【面条/米线/卷饼】减脂一般不作为常规主食，一份的碳水量高达80-160g。

【煎蛋炒蛋】一个煎蛋是6g蛋白质，因为巨量吸油，脂肪量至少20g。

【糖油混合物】饼干、蛋糕、点心、糕点、甜品、油条、煎饼、花式面包、膨化食品等。` },
            { question: "吃食堂或工作餐该怎么办？", answer: `吃食堂或工作餐本身没问题，关键是看你在具体吃什么。

【务必要分清楚食物性质】最重要的是排除高脂肉和糖油混合物，否则你的脂肪摄入必爆，减脂增肌都不能这么吃！

【初期做做碳水和蛋白质定量】第二步才是表格里的碳水和蛋白质的定量，不是天天顿顿称，而是初期把你经常性食物测一下就行了。

【关于菜肴里的油】一般的带油烧菜不用害怕，但夹起来会直接淌油的重油菜肴，要把菜肴在盘边刮一刮，让附着的油量少一些。` },
            { question: "吃外卖该怎么办？", answer: `【正确的外卖】用主食+瘦肉模式的外卖是最简单的，例如黄焖鸡、海南鸡、酸菜鱼、跷脚牛肉、鸡腿饭、瘦肉炒菜配米饭等。外卖米饭，长方形饭盒大约是100g碳水/盒。

【错误的外卖】①缺乏瘦肉的外卖，比如面条、米线、盖饭；②混合餐外卖，比如轻食、健康餐；③高脂肉外卖：肉类只能吃瘦肉，高脂肉必须能识别和回避。` },
            { question: "在外就餐怎么办？", answer: `在外就餐不影响减脂。在外就餐桌上摆的还是碳蛋脂，只是无法定量而已，影响不大。碳水量参考你既往的主食量来吃即可，瘦肉量可以比较随意，蔬菜随意。

特别需要注意的就是少吃不吃【高脂肉】和【糖油混合物】。减脂饮食在任何场合都少吃不吃高脂肉和糖油混合物，最多就是浅尝解馋而已，这样脂肪摄入才不会爆炸。` },
            { question: "减脂期需要吃放纵餐吗？", answer: `我们的饮食方案，每餐都是主食（量还行）+你喜欢的瘦肉菜、蔬菜，排除的食物就只有糖油混合物和高脂肉而已，所以就不痛苦，在如此宽松的饮食里，也不需要定期去"放纵"来"缓解痛苦"。

不过，如果你的饮食习惯是，不吃高脂肉，不吃糖油混合物，就会陷入痛苦，那你确实可以定期去"放纵"吃这些，但因为热量确实高，不可避免会影响减脂，这件事就自己取舍了。` },
            { question: "为什么喝酒对减脂的破坏很大？", answer: `①酒的热量来自酒精，非常高！
1两白酒（50g）热量：50g重量×50%酒精率×7大卡/g=175大卡=44g碳水
1瓶啤酒（600g）热量：600g重量×（4%碳水率×4大卡/g+3%酒精率×7大卡/g）=222大卡=56g碳水
简单数据：1两白酒=1瓶啤酒=200大卡=50g碳水的热量

②必须被迫喝酒该怎么办？
先试算出自己每周的酒精热量，再用增加等量的有氧量去对冲。例如，每周需要喝白酒5两，当周就额外做有氧：5两×200大卡=1000大卡。` },
            { question: "减脂期间感觉饿怎么办？", answer: `①最重要的是选择高饱腹感主食：米饭、燕麦麸、燕麦片、土豆、红薯、玉米。

②多吃蔬菜。蔬菜能抗饿，除了力量训练的练后餐，其他任何各餐都是多吃、先吃蔬菜。

③吃够瘦肉。各餐蛋白质配额都给得较高，请把瘦肉吃足。

④用零食夜宵的配额来垫肚子。

⑤增加一定有氧来换取碳水。` },
            { question: "为什么减脂是体重越大越不需要有氧？", answer: `体重决定基础代谢，基础代谢又是人体最主要的热量消耗。因此，体重越大，基础代谢就越高，热量消耗就越高，减脂期能吃的饮食热量就越高。

体重>80kg者，基础代谢足够高，只靠饮食提供热量缺口，排除了低饱腹感高热量的食物，吃起来都不会饿的，所以不需要加有氧。

体重70-80kg者，多数人吃起来也不太饿，因此不需要加有氧，但也有部分人会觉得饿，则应该考虑加有氧。

体重<70kg者，基础代谢比较低，多数人也会有些饥饿感，因此默认建议每周做2小时有氧。` },
            { question: "为什么体脂称/体测仪的体脂和肌肉数据是不可信的？", answer: `生物抗阻抗法的体脂称/体测仪的数据只有体重有用，骨骼肌、体脂肪数据都不要当真。基础代谢也不是"测"出来的，而是根据你的体重代入内置的公式计算的。

如果肌肉脂肪的变化量很小（比如几天几周的变化），体测仪的精度测不出来。如果确实非常关心自己的脂肪和肌肉量，可以去医院用"双能X射线吸收法"（DEXA）测身体成分。` },
            { question: "为什么两三天的体重变化没有意义？", answer: `影响每日体重变化的因素：①未排出的食糜。食物消化排出需要1-4天；②人体脱水吸水。较低的盐分摄入能导致人体脱水掉体重，较高的盐分摄入能导致人体吸水长体重；③脂肪的分解合成。这是大家关心的，但非常微弱。

既然即便在正确减脂，每天的脂肪分解量也只占体重波动的百分之几而已，所以根本不可能通过每天的体重变化来判断脂肪量变化的。必须持续积累，用1-2周的变化来对比。` },
            { question: "有什么低热量能短暂填肚子的零食？", answer: `①蛋白质类：
低糖鸡肉干、内蒙牛肉干、柏香去皮熟鸡腿、泰森鸡胸肉条、无穷盐焗鸡腿

②本身热量很低：
卫龙海带丝/魔芋爽、各种魔芋类零食商品、各种蔬菜

③本身热量不低但能吃的量很少：
有友泡椒凤爪、黑巧克力（80%以上黑巧浓度）

④无热量饮料：
纯水乐苏打气泡水、无糖气泡饮料` }
        ];

        // 增肌Q&A数据
        let bulkQAData = [
            { question: "执行了一个月但体重不长该怎么调整？", answer: `增肌期体重的建议增速，男性每月体重增加1-2斤，女性每月体重增加0.5-1斤。

为什么要求增速这么慢？因为肌肉合成速度比脂肪分解速度要慢得多，平均每天能合成10g肌肉已经很高效了，每月的肌肉增量最多也就300g，如果体重增加数倍于此，则多出的都是脂肪。

如果增肌体重一个月都毫无变化，那就是确实处于热量平衡状态，还得加热量。加热量的办法：每天增加碳水30-60g（约为米饭100-200g），或者增加脂肪10-20g。` },
            { question: "为什么要新手初期要定量饮食？", answer: `因为新手对日常食物的碳蛋脂量没有概念，按感觉吃饭大概率会导致碳蛋脂的总量严重错误。如果按感觉吃饭能八九不离十，那大家也不会有增肌体重不长，或者增长过快长成胖子的问题了。

当然，增肌饮食的精确度要求比减脂更低，因为增肌期的热量摄入要高得多，对因为定量错误、食物错误导致的饮食热量错误的容错能力更高，所以增肌饮食不用过于精细和紧张。` },
            { question: "难道要一直称重吃饭？食物是生重还是熟重？", answer: `不要理解成一直天天顿顿用食物称来称重，而是初期把你经常性食物测一下就行了：

①碳水很好定量，米饭/馒头等主食的重量是大体固定的；
②蛋白质的定量，早饭鸡蛋牛奶按数量论很简单，午饭晚饭瘦肉需要称重几次培养对瘦肉体积的认识；
③脂肪则不用定量，就用表格里的脂肪摄入推荐模式。

生熟问题：米饭、面条的生熟重量差别很大，所以表格里生熟重量都写了，一定要分清。` },
            { question: "是否有一些固定重量的食物？", answer: `【外卖米饭（长方形盒）】碳水100g/盒
【外卖米饭（圆形扁盒）】碳水75g/盒
【吐司切片面包】碳水25g/片
【鸡翅根（去皮）】蛋白质8g/个
【小鸡腿（去皮）】蛋白质15g/个
【全鸡腿（去皮）】蛋白质40g/个
【苹果/橙子/香蕉】碳水20-30g/个` },
            { question: "表格里哪些食物如果不定量会被严重错估？", answer: `【面条/米线/卷饼】容易被低估碳水量。这些是饱腹感最低的主食，一份的碳水量高达80-160g，增肌也只有碳水量最大的练后餐会考虑作为主食。

【菜肴的瘦肉量】容易被高估蛋白质。食堂外卖餐馆的一人份瘦肉菜肴，瘦肉量一般很难超过100g（蛋白质25g）。

【个别特殊菜肴】容易被低估脂肪量。需要回避：炒鸡蛋、炒茄子、油炸菜等。` },
            { question: "哪些食物是需要特别提醒的？", answer: `【糖油混合物】面粉+油制作的食物，如饼干、蛋糕、点心等。

【高脂肉】瘦肉之外的肉类，如鸡皮鸭皮、猪大排、糖醋里脊等，脂肪率高得多而蛋白质率又低得多。

【瘦肉】表格里是肉是指瘦肉，瘦肉的脂肪率一般低于5%。

【面条/米线/卷饼】这些是饱腹感最低的主食，增肌也只有碳水量最大的练后餐会考虑作为主食。` },
            { question: "增肌到什么程度应该转减脂？", answer: `停止增肌的标准主要取决于个人审美。BMI=体重kg÷身高m÷身高m，如果介意发胖，男性23<BMI<24，女性21<BMI<22就可以考虑减脂；如果不介意发胖，可以继续增到男性24<BMI<25，女性22<BMI<23再考虑减脂。` },
            { question: "为什么体脂称/体测仪的体脂和肌肉数据是不可信的？", answer: `生物抗阻抗法的体脂称/体测仪的数据只有体重有用，骨骼肌、体脂肪数据都不要当真。基础代谢也不是"测"出来的，而是根据你的体重代入内置的公式计算的。

如果肌肉脂肪的变化量很小（比如几天几周的变化），体测仪的精度测不出来。如果确实非常关心自己的脂肪和肌肉量，可以去医院用"双能X射线吸收法"（DEXA）测身体成分。` },
            { question: "吃外卖该怎么办？", answer: `【正确的外卖】单独的主食+较多的瘦肉，这样才方便定量。外卖米饭，长方形盒碳水90g/盒，圆形盒碳水75g/盒，瘦肉量自己称重定一下看够不够，如果不够，考虑加一份肉。搜索关键词：跷脚牛肉、酸菜鱼、沙县、各种带"鸡"字的。

【错误的外卖】①缺乏瘦肉的外卖，比如面条、米线、盖饭；②混合餐外卖，比如轻食、健康餐；③高脂肉外卖：以高脂肉作为肉类的外卖，都不应作为日常食物。` },
            { question: "食堂外卖的瘦肉量吃不够怎么办？", answer: `吃食堂外卖，碳水和脂肪都不会缺的，容易缺的是瘦肉，如果确实找不到瘦肉，该怎么满足蛋白质摄入呢：①自己卤或者在熟食店买一些鸡腿/酱牛肉之类的瘦肉；②电商买真空包装的速食鸡胸肉/牛肉；③蛋白粉替代，蛋白粉的蛋白质率高达约80%。

但必须提醒，如果你因为吃卤肉/蛋白粉而不怎么吃大众带油炒菜的话，则属于表格里脂肪缺乏的情况，请参照表格指导来补充脂肪摄入。` },
            { question: "在外就餐怎么办？", answer: `在外就餐不影响减脂，更不会影响增肌了。在外就餐桌上摆的还是碳蛋脂，只是无法定量而已，影响不大。碳水量参考你既往的主食量来吃即可，瘦肉量可以比较随意，蔬菜随意。

特别需要注意的就是少吃不吃【高脂肉】和【糖油混合物】。当然，增肌期需要热量盈余，对"脏"食物的容纳能力肯定比减脂期强一些，有时候吃吃也无妨，但仍然不能作为基础食物。` },
            { question: "高尿酸/痛风患者建议怎样处理饮食？", answer: `蛋白质来源里鸡蛋、牛奶、蛋白粉是没嘌呤的，肉类里猪牛羊嘌呤较低，建议：

①早饭吃鸡蛋牛奶，午饭晚饭吃瘦肉优先用嘌呤较少的牛肉，少用鸡肉、海鲜；
②如果有蛋白粉，瘦肉可以减半，另一半蛋白质用蛋白粉；
③大量喝水，每天达到2-3L；
④控制果糖摄入，主要来源是水果和糖饮料；
⑤严控啤酒白酒，尽量别喝；
⑥定期复查，严重超标就遵医嘱吃药。` },
            { question: "为什么不要追求增肌减脂同时进行？", answer: `增肌减脂确实可以同时进行，比如一个刚开始力训的新手，即便用的是减脂饮食配额让体重下降，肌肉量仍然可能是略微增长的，但这种增肌量和用增肌饮食配额是不能比的。

所以，这些"增肌减脂同时进行"的情况确实存在，但并不是大家希望的那样"增肌和减脂两头都同时最大化，用一倍的时间达成别人两倍时间的效果"。总之，该减脂就减脂，该增肌就增肌，而不用去想要"两头都要同时最大化"。` }
        ];

        function initData() {
            const categories = [...new Set(nutritionData.map(item => item.category))];
            setupCategories(categories);
            renderNutritionCards();
            setupNavigation();
            populateFoodSelectors();
            setupQAPage();
        }

        function setupNavigation() {
            const navBtns = document.querySelectorAll('.nav-btn');
            navBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const targetPage = btn.dataset.page;
                    switchPage(targetPage);
                    
                    navBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    
                    // 更新移动端下拉按钮文本
                    const dropdownToggle = document.querySelector('.nav-dropdown-toggle');
                    if (dropdownToggle) {
                        dropdownToggle.textContent = btn.textContent;
                    }
                    
                    // 在移动端点击选项后收起下拉菜单
                    const navTabs = document.querySelector('.nav-tabs');
                    if (navTabs) {
                        navTabs.classList.remove('show');
                        dropdownToggle.classList.remove('active');
                    }
                });
            });
        }

        function toggleMobileNav() {
            const navTabs = document.querySelector('.nav-tabs');
            const dropdownToggle = document.querySelector('.nav-dropdown-toggle');
            
            navTabs.classList.toggle('show');
            dropdownToggle.classList.toggle('active');
        }

        function switchPage(page) {
            const pages = document.querySelectorAll('.page-content');
            pages.forEach(p => p.classList.remove('active'));
            
            const targetPage = document.getElementById(page + '-page');
            if (targetPage) {
                targetPage.classList.add('active');
            }

            if (page === 'calculator') {
                document.querySelector('.meal-calculator').classList.add('active');
            }
        }

        function calculateMealTargets() {
            const dailyCarbs = parseFloat(document.getElementById('dailyCarbs').value);
            const dailyProtein = parseFloat(document.getElementById('dailyProtein').value);
            
            if (!dailyCarbs || !dailyProtein) {
                alert('请输入每日碳水化合物和蛋白质需求量');
                return;
            }

            const mealRatios = {
                breakfast: { carbs: 0.20, protein: 0.20 },
                lunch: { carbs: 0.35, protein: 0.30 },
                dinner: { carbs: 0.35, protein: 0.30 },
                snack: { carbs: 0.10, protein: 0.20 }
            };

            Object.keys(mealRatios).forEach(meal => {
                const carbsTarget = Math.round(dailyCarbs * mealRatios[meal].carbs);
                const proteinTarget = Math.round(dailyProtein * mealRatios[meal].protein);
                
                mealPlans[meal].targetCarbs = carbsTarget;
                mealPlans[meal].targetProtein = proteinTarget;
                
                document.getElementById(`${meal}-carbs`).textContent = `${carbsTarget}g`;
                document.getElementById(`${meal}-protein`).textContent = `${proteinTarget}g`;
            });

            document.getElementById('mealsGrid').style.display = 'grid';
        }

        function populateFoodSelectors() {
            const meals = ['breakfast', 'lunch', 'dinner', 'snack'];
            meals.forEach(meal => {
                const select = document.getElementById(`${meal}-food-select`);
                select.innerHTML = '<option value="">选择食物</option>';
                
                nutritionData.forEach((food, index) => {
                    const option = document.createElement('option');
                    option.value = index;
                    option.textContent = `${food.food} (${food.category})`;
                    select.appendChild(option);
                });
            });
        }

        function addFoodToMeal(mealType) {
            const selectId = `${mealType}-food-select`;
            const select = document.getElementById(selectId);
            const foodIndex = parseInt(select.value);
            
            if (isNaN(foodIndex)) {
                alert('请选择一个食物');
                return;
            }

            const food = nutritionData[foodIndex];
            const targetCarbs = mealPlans[mealType].targetCarbs;
            const targetProtein = mealPlans[mealType].targetProtein;
            
            let weight = calculateFoodWeight(food, targetCarbs, targetProtein);
            
            if (weight > 0) {
                const foodItem = {
                    ...food,
                    weight: weight,
                    actualCarbs: calculateNutrient(food.carbohydrate, weight),
                    actualProtein: calculateNutrient(food.carbohydrate, weight, food.category === '干净蛋白质' || food.category === '含有蛋白质的混合物')
                };
                
                mealPlans[mealType].foods.push(foodItem);
                renderMealFoods(mealType);
                updateMealSummary(mealType);
                select.value = '';
            }
        }

        function calculateFoodWeight(food, targetCarbs, targetProtein) {
            const isProteinFood = food.category === '干净蛋白质' || food.category === '含有蛋白质的混合物';
            let rate = parseFloat(food.carbohydrate.replace('%', '').replace('g/', '').replace('g/个', '').replace('g/250ml盒', '').replace('g/200ml盒', ''));
            
            if (isNaN(rate)) return 100;
            
            let weight;
            if (isProteinFood) {
                if (food.carbohydrate.includes('g/')) {
                    weight = (targetProtein / rate) * (food.carbohydrate.includes('个') ? 1 : 100);
                } else {
                    weight = (targetProtein / rate) * 100;
                }
            } else {
                weight = (targetCarbs / rate) * 100;
            }
            
            return Math.round(weight);
        }

        function calculateNutrient(value, weight, isProtein = false) {
            let rate = parseFloat(value.replace('%', '').replace('g/', '').replace('g/个', '').replace('g/250ml盒', '').replace('g/200ml盒', ''));
            
            if (isNaN(rate)) return 0;
            
            if (value.includes('g/')) {
                if (value.includes('个')) {
                    return Math.round((rate * weight));
                } else {
                    return Math.round((rate * weight) / 100);
                }
            } else {
                return Math.round((rate * weight) / 100);
            }
        }

        function renderMealFoods(mealType) {
            const container = document.getElementById(`${mealType}-foods`);
            const foods = mealPlans[mealType].foods;
            
            container.innerHTML = foods.map((food, index) => `
                <div class="selected-food-item">
                    <div>
                        <strong>${food.food}</strong><br>
                        <span class="food-weight">${food.weight}g</span>
                    </div>
                    <button class="remove-food" onclick="removeFoodFromMeal('${mealType}', ${index})">删除</button>
                </div>
            `).join('');
        }

        function removeFoodFromMeal(mealType, index) {
            mealPlans[mealType].foods.splice(index, 1);
            renderMealFoods(mealType);
            updateMealSummary(mealType);
        }

        function updateMealSummary(mealType) {
            const foods = mealPlans[mealType].foods;
            let totalCarbs = 0;
            let totalProtein = 0;
            
            foods.forEach(food => {
                const isProteinFood = food.category === '干净蛋白质' || food.category === '含有蛋白质的混合物';
                
                if (isProteinFood) {
                    totalProtein += calculateNutrient(food.carbohydrate, food.weight);
                    if (food.category === '含有蛋白质的混合物') {
                        totalCarbs += calculateNutrient(food.carbohydrate, food.weight) * 0.1; // 估算碳水
                    }
                } else {
                    totalCarbs += calculateNutrient(food.carbohydrate, food.weight);
                }
            });
            
            document.getElementById(`${mealType}-current-carbs`).textContent = `${Math.round(totalCarbs)}g`;
            document.getElementById(`${mealType}-current-protein`).textContent = `${Math.round(totalProtein)}g`;
        }

        // 热量计算相关函数
        function calculateCalories() {
            const gender = document.getElementById('gender').value;
            const age = parseFloat(document.getElementById('age').value);
            const height = parseFloat(document.getElementById('height').value);
            const weight = parseFloat(document.getElementById('weight').value);
            const goal = document.getElementById('goal').value;
            const cardio = parseFloat(document.getElementById('cardioConsumption').value) || 0;
            const strengthLevel = document.getElementById('strengthLevel').value;

            if (!gender || !age || !height || !weight || !goal) {
                alert('请填写所有基本信息');
                return;
            }

            // 对于有力量训练的目标，检查是否选择了力训水平
            if ((goal === 'bulk' || goal === 'cut-with-training') && !strengthLevel) {
                alert('请选择力量训练水平');
                return;
            }

            // 计算BMI
            const bmi = calculateBMI(weight, height);
            const bmiStatus = getBMIStatus(bmi);
            
            // 计算基础代谢（使用修正的公式）
            const bmr = calculateBMR(gender, weight, height, age);

            // 显示结果
            document.getElementById('bmiValue').textContent = bmi.toFixed(1);
            document.getElementById('bmiStatus').textContent = bmiStatus;
            document.getElementById('bmrValue').textContent = Math.round(bmr);
            document.getElementById('calorieResults').style.display = 'block';

            // 隐藏所有详细输入区域
            // hideAllDetailedInputs();

            // 根据目标显示相应的热量计算
            if (goal === 'bulk') {
                showBulkCalculation(bmr, cardio, gender, strengthLevel);
            } else if (goal === 'cut-no-training') {
                showCutNoTrainingCalculation(bmr, cardio);
            } else if (goal === 'cut-with-training') {
                showCutWithTrainingCalculation(bmr, cardio, gender, strengthLevel);
            }
        }

        function getStrengthTrainingCalories(gender, level) {
            const maleCalories = { beginner: 150, intermediate: 200, advanced: 250 };
            const femaleCalories = { beginner: 100, intermediate: 150, advanced: 200 };
            
            return gender === 'male' ? maleCalories[level] : femaleCalories[level];
        }

        function calculateBMI(weight, height) {
            const heightInMeters = height / 100;
            return weight / (heightInMeters * heightInMeters);
        }

        function getBMIStatus(bmi) {
            if (bmi < 18.5) return '偏瘦';
            if (bmi < 24) return '正常';
            if (bmi < 28) return '超重';
            return '肥胖';
        }

        function calculateBMR(gender, weight, height, age) {
            if (gender === 'male') {
                return weight * 9.99 + height * 6.25 - age * 4.92 + 5;
            } else {
                return weight * 9.99 + height * 6.25 - age * 4.92 - 161;
            }
        }

        function hideAllDetailedInputs() {
            // 不再需要详细输入区域
        }

        function showBulkCalculation(bmr, cardio, gender, strengthLevel) {
            // 计算无运动总消耗和力训消耗
            const noExerciseTotal = Math.round(bmr / 0.7);
            const strength = getStrengthTrainingCalories(gender, strengthLevel);
            
            // 增肌计算：平衡热量和应摄入热量
            const balanceTrainingDay = noExerciseTotal + cardio + strength;
            const balanceRestDay = noExerciseTotal + cardio;
            const intakeTrainingDay = Math.round(balanceTrainingDay * 0.84);
            const intakeRestDay = Math.round(balanceRestDay * 0.84);

            showBreakdown('增肌热量分配', [
                { label: '基础代谢', value: Math.round(bmr) },
                { label: '无运动总消耗', value: noExerciseTotal },
                { label: '有氧训练消耗', value: cardio },
                { label: '力量训练消耗', value: strength },
                { label: '平衡热量（力训日）', value: balanceTrainingDay },
                { label: '平衡热量（休息日）', value: balanceRestDay },
                { label: '应摄入热量（力训日）', value: intakeTrainingDay, isIntake: true },
                { label: '应摄入热量（休息日）', value: intakeRestDay, isIntake: true }
            ]);
        }

        function showCutNoTrainingCalculation(bmr, cardio) {
            // 减脂无力量训练
            const noExerciseTotal = Math.round(bmr / 0.7);
            const balanceCalories = noExerciseTotal + cardio;
            const intakeCalories = Math.round(balanceCalories * 0.64);

            showBreakdown('减脂热量分配（无力量训练）', [
                { label: '基础代谢', value: Math.round(bmr) },
                { label: '无运动总消耗', value: noExerciseTotal },
                { label: '有氧训练消耗', value: cardio },
                { label: '平衡热量', value: balanceCalories },
                { label: '应摄入热量', value: intakeCalories, isIntake: true }
            ]);
        }

        function showCutWithTrainingCalculation(bmr, cardio, gender, strengthLevel) {
            // 计算无运动总消耗和力训消耗
            const noExerciseTotal = Math.round(bmr / 0.7);
            const strength = getStrengthTrainingCalories(gender, strengthLevel);
            
            // 减脂有力训计算：平衡热量和应摄入热量
            const balanceTrainingDay = noExerciseTotal + cardio + strength;
            const balanceRestDay = noExerciseTotal + cardio;
            const intakeTrainingDay = Math.round(balanceTrainingDay * 0.64);
            const intakeRestDay = Math.round(balanceRestDay * 0.64);

            showBreakdown('减脂热量分配（有力量训练）', [
                { label: '基础代谢', value: Math.round(bmr) },
                { label: '无运动总消耗', value: noExerciseTotal },
                { label: '有氧训练消耗', value: cardio },
                { label: '力量训练消耗', value: strength },
                { label: '平衡热量（力训日）', value: balanceTrainingDay },
                { label: '平衡热量（休息日）', value: balanceRestDay },
                { label: '应摄入热量（力训日）', value: intakeTrainingDay, isIntake: true },
                { label: '应摄入热量（休息日）', value: intakeRestDay, isIntake: true }
            ]);
        }

        function showBreakdown(title, items) {
            let html = `<div class="breakdown-title">${title}</div>`;
            
            items.forEach(item => {
                const isIntake = item.isIntake;
                const itemClass = isIntake ? 'intake' : '';
                html += `
                    <div class="breakdown-item ${itemClass}">
                        <span class="breakdown-label">${item.label}</span>
                        <span class="breakdown-value">${item.value}大卡</span>
                    </div>
                `;
            });

            document.getElementById('calorieBreakdown').innerHTML = html;
        }

        // Q&A相关函数
        function setupQAPage() {
            // 设置Q&A类型切换按钮
            const qaTypeBtns = document.querySelectorAll('.qa-type-btn');
            qaTypeBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const targetType = btn.dataset.type;
                    switchQAType(targetType);
                    
                    qaTypeBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                });
            });

            // 初始化显示减脂Q&A
            renderQASection('cut', cutQAData);
            renderQASection('bulk', bulkQAData);
        }

        function switchQAType(type) {
            const qaSections = document.querySelectorAll('.qa-section');
            qaSections.forEach(section => section.classList.remove('active'));
            
            const targetSection = document.getElementById(type + '-qa');
            if (targetSection) {
                targetSection.classList.add('active');
            }
        }

        function renderQASection(type, qaData) {
            const container = document.getElementById(type + '-qa');
            let html = '';
            
            qaData.forEach((qa, index) => {
                // 处理答案文本：去掉多余空行，用段落标签分隔
                const processedAnswer = qa.answer
                    .trim()                           // 去掉首尾空白
                    .replace(/\n\s*\n\s*\n+/g, '\n\n') // 将多个空行替换为双换行
                    .split('\n\n')                    // 按双换行分割段落
                    .filter(paragraph => paragraph.trim()) // 过滤空段落
                    .map(paragraph => `<p>${paragraph.replace(/\n/g, '<br>')}</p>`) // 段落内换行用<br>
                    .join('');
                
                html += `
                    <div class="qa-item" data-index="${index}">
                        <div class="qa-question" onclick="toggleQAAnswer(this)">
                            <span>${qa.question}</span>
                            <span class="qa-toggle-icon">▼</span>
                        </div>
                        <div class="qa-answer">
                            ${processedAnswer}
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function toggleQAAnswer(element) {
            const qaItem = element.parentElement;
            qaItem.classList.toggle('expanded');
        }

        function calculateDetailedCalories() {
            // 不再需要详细输入重新计算功能
        }

        function calculateCutWithTraining() {
            // 不再需要详细输入重新计算功能
        }

        function setupCategories(categories) {
            const categoryTabs = document.getElementById('categoryTabs');
            const allButton = categoryTabs.querySelector('[data-category="all"]');
            
            categories.forEach(category => {
                const button = document.createElement('button');
                button.className = 'category-tab';
                button.dataset.category = category;
                button.textContent = category;
                button.addEventListener('click', () => filterByCategory(category, button));
                categoryTabs.appendChild(button);
            });
            
            allButton.addEventListener('click', () => filterByCategory('all', allButton));
        }

        function filterByCategory(category, button) {
            currentCategory = category;
            document.querySelectorAll('.category-tab').forEach(tab => tab.classList.remove('active'));
            button.classList.add('active');
            renderNutritionCards();
        }

        function filterData() {
            return nutritionData.filter(item => {
                const matchesCategory = currentCategory === 'all' || item.category === currentCategory;
                const matchesSearch = searchQuery === '' || 
                    item.food.toLowerCase().includes(searchQuery.toLowerCase()) ||
                    item.category.toLowerCase().includes(searchQuery.toLowerCase());
                return matchesCategory && matchesSearch;
            });
        }

        function renderNutritionCards() {
            const container = document.getElementById('nutritionContainer');
            const filteredData = filterData();
            
            if (filteredData.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="8" x2="12" y2="12"></line>
                            <line x1="12" y1="16" x2="12.01" y2="16"></line>
                        </svg>
                        <h3>暂无数据</h3>
                        <p>没有找到匹配的食物信息</p>
                    </div>
                `;
                return;
            }
            
            const groupedData = {};
            filteredData.forEach(item => {
                if (!groupedData[item.category]) {
                    groupedData[item.category] = [];
                }
                groupedData[item.category].push(item);
            });
            
            let html = '';
            Object.keys(groupedData).forEach(category => {
                if (currentCategory === 'all') {
                    html += `<div class="category-section">
                        <h2 class="category-title">${category}</h2>`;
                }
                
                html += `<table class="nutrition-table">
                    <thead>
                        <tr>
                            <th>分类</th>
                            <th>食物名称</th>
                            <th>${category === '蛋白质' ? '蛋白质含量' : '碳水化合物'}</th>
                            <th>GI指数</th>
                            <th>详细说明</th>
                        </tr>
                    </thead>
                    <tbody>`;
                
                groupedData[category].forEach(item => {
                    html += `
                        <tr>
                            <td class="category-cell">${item.category}</td>
                            <td class="food-name-cell">${item.food}</td>
                            <td class="carb-rate-cell">${item.carbohydrate}</td>
                            <td class="gi-cell">
                                ${item.gi ? `<span class="gi-badge gi-${item.gi}">${item.gi}</span>` : '-'}
                            </td>
                            <td class="description-cell">
                                ${item.description ? item.description.replace(/\n/g, '<br>') : '-'}
                            </td>
                        </tr>
                    `;
                });
                
                html += '</tbody></table>';
                
                if (currentCategory === 'all') {
                    html += '</div>';
                }
            });
            
            container.innerHTML = html;
        }

        document.getElementById('searchInput').addEventListener('input', (e) => {
            searchQuery = e.target.value;
            renderNutritionCards();
        });

        initData();
    </script>
</body>
</html>