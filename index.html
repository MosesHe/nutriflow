<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NutriFlow - 智能营养助手</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .nav-bar {
            background: white;
            border-bottom: 1px solid #e2e8f0;
            padding: 0;
        }

        .nav-tabs {
            display: flex;
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .nav-tab {
            flex: 1;
            text-align: center;
        }

        .nav-tab button {
            width: 100%;
            padding: 20px 30px;
            border: none;
            background: none;
            font-size: 16px;
            font-weight: 600;
            color: #64748b;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }

        .nav-tab button:hover {
            background: #f8fafc;
            color: #43cea2;
        }

        .nav-tab button.active {
            color: #43cea2;
            border-bottom-color: #43cea2;
        }

        .header {
            background: linear-gradient(135deg, #43cea2 0%, #185a9d 100%);
            padding: 30px;
            text-align: center;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 300;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .search-section {
            padding: 30px;
            background: #f8fafc;
            border-bottom: 1px solid #e2e8f0;
        }

        .search-box {
            max-width: 600px;
            margin: 0 auto;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 15px 20px 15px 50px;
            font-size: 16px;
            border: 2px solid #e2e8f0;
            border-radius: 50px;
            outline: none;
            transition: all 0.3s ease;
            background: white;
        }

        .search-input:focus {
            border-color: #43cea2;
            box-shadow: 0 0 0 3px rgba(67, 206, 162, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 18px;
            top: 50%;
            transform: translateY(-50%);
            color: #64748b;
        }

        .category-nav {
            padding: 20px 30px;
            background: white;
            border-bottom: 1px solid #e2e8f0;
            overflow-x: auto;
        }

        .category-tabs {
            display: flex;
            gap: 10px;
            min-width: fit-content;
        }

        .category-tab {
            padding: 10px 20px;
            background: #f1f5f9;
            border: none;
            border-radius: 25px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .category-tab.active {
            background: #43cea2;
            color: white;
        }

        .category-tab:hover {
            background: #e2e8f0;
        }

        .category-tab.active:hover {
            background: #2ca889;
        }

        .content {
            padding: 30px;
        }

        .nutrition-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .nutrition-table thead {
            background: #43cea2;
            color: white;
        }

        .nutrition-table th {
            padding: 15px 20px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .nutrition-table tbody tr {
            border-bottom: 1px solid #f1f5f9;
            transition: all 0.3s ease;
        }

        .nutrition-table tbody tr:hover {
            background: #f8fafc;
        }

        .nutrition-table tbody tr:last-child {
            border-bottom: none;
        }

        .nutrition-table td {
            padding: 20px;
            vertical-align: top;
        }

        .food-name-cell {
            font-weight: 600;
            color: #1e293b;
            min-width: 150px;
        }

        .category-cell {
            color: #64748b;
            font-size: 14px;
            min-width: 100px;
        }

        .carb-rate-cell {
            font-weight: 700;
            color: #43cea2;
            font-size: 16px;
            min-width: 80px;
        }

        .gi-cell {
            min-width: 80px;
        }

        .description-cell {
            color: #64748b;
            line-height: 1.6;
            font-size: 14px;
            max-width: 400px;
        }

        .gi-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: inline-block;
        }

        .gi-高 {
            background: #fee2e2;
            color: #dc2626;
        }

        .gi-中 {
            background: #fef3c7;
            color: #d97706;
        }

        .gi-低 {
            background: #dcfce7;
            color: #16a34a;
        }

        .category-section {
            margin-bottom: 40px;
        }

        .category-title {
            font-size: 1.8rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #43cea2;
            display: inline-block;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #64748b;
        }

        .empty-state svg {
            width: 80px;
            height: 80px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .meal-calculator {
            display: none;
            padding: 30px;
        }

        .meal-calculator.active {
            display: block;
        }

        .daily-input-section {
            background: #f8fafc;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .input-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .input-item {
            display: flex;
            flex-direction: column;
        }

        .input-label {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 8px;
        }

        .input-field {
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .input-field:focus {
            outline: none;
            border-color: #43cea2;
        }

        .calculate-btn {
            background: #43cea2;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .calculate-btn:hover {
            background: #2ca889;
        }

        .meals-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .meal-card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .meal-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 15px;
            text-align: center;
        }

        .meal-targets {
            background: #f1f5f9;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .target-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .target-item:last-child {
            margin-bottom: 0;
        }

        .target-label {
            color: #64748b;
        }

        .target-value {
            font-weight: 600;
            color: #43cea2;
        }

        .food-selector {
            margin-bottom: 15px;
        }

        .food-select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .food-select:focus {
            outline: none;
            border-color: #43cea2;
        }

        .selected-foods {
            margin-top: 15px;
        }

        .selected-food-item {
            background: #e6f7ff;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .food-weight {
            font-weight: 600;
            color: #43cea2;
        }

        .remove-food {
            background: #ef4444;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
        }

        .add-food-btn {
            background: #43cea2;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            width: 100%;
        }

        .nutrition-summary {
            background: #f8fafc;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .page-content {
            display: none;
        }

        .page-content.active {
            display: block;
        }

        .calorie-calculator {
            padding: 30px;
        }

        .user-info-section {
            background: #f8fafc;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .info-group {
            display: flex;
            flex-direction: column;
        }

        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .results-section {
            margin-bottom: 30px;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .result-card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .result-card h3 {
            color: #64748b;
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 15px;
        }

        .result-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: #43cea2;
            line-height: 1;
        }

        .result-unit, .result-status {
            font-size: 14px;
            color: #64748b;
            margin-top: 8px;
        }

        .calorie-breakdown {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .breakdown-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 20px;
            text-align: center;
        }

        .breakdown-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f1f5f9;
        }

        .breakdown-item:last-child {
            border-bottom: none;
        }

        .breakdown-item.intake {
            font-weight: 600;
        }

        .breakdown-item.intake .breakdown-value {
            color: #0ea5e9;
            font-weight: 700;
            font-size: 1.1rem;
        }

        .breakdown-label {
            color: #64748b;
        }

        .breakdown-value {
            font-weight: 600;
            color: #43cea2;
        }

        .detailed-input-section {
            background: #f8fafc;
            padding: 25px;
            border-radius: 15px;
            margin-top: 20px;
        }

        .detailed-input-section small {
            display: block;
            color: #64748b;
            font-size: 12px;
            margin-top: 4px;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }

            .nutrition-table {
                font-size: 14px;
            }

            .nutrition-table th,
            .nutrition-table td {
                padding: 12px 8px;
            }

            .description-cell {
                max-width: 200px;
            }

            .info-grid {
                grid-template-columns: 1fr;
            }

            .results-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="nav-bar">
            <ul class="nav-tabs">
                <li class="nav-tab">
                    <button class="nav-btn active" data-page="nutrition">营养成分表</button>
                </li>
                <li class="nav-tab">
                    <button class="nav-btn" data-page="calculator">三餐摄入计算</button>
                </li>
                <li class="nav-tab">
                    <button class="nav-btn" data-page="calorie">热量计算器</button>
                </li>
            </ul>
        </div>

        <!-- 营养成分表页面 -->
        <div class="page-content active" id="nutrition-page">
            <div class="header">
                <h1>NutriFlow</h1>
                <p>智能营养助手 - 营养成分表</p>
            </div>

            <div class="search-section">
                <div class="search-box">
                    <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="M21 21L16.65 16.65"></path>
                    </svg>
                    <input type="text" class="search-input" placeholder="搜索食物..." id="searchInput">
                </div>
            </div>

            <div class="category-nav">
                <div class="category-tabs" id="categoryTabs">
                    <button class="category-tab active" data-category="all">全部</button>
                </div>
            </div>

            <div class="content" id="content">
                <div class="nutrition-container" id="nutritionContainer">
                </div>
            </div>
        </div>

        <!-- 三餐摄入计算页面 -->
        <div class="page-content" id="calculator-page">
            <div class="header">
                <h1>NutriFlow</h1>
                <p>智能营养助手 - 三餐摄入计算</p>
            </div>
            
            <div class="meal-calculator">
                <div class="daily-input-section">
                    <h3 style="margin-bottom: 20px; color: #1e293b;">每日营养需求</h3>
                    <div class="input-group">
                        <div class="input-item">
                            <label class="input-label">碳水化合物总量 (克)</label>
                            <input type="number" class="input-field" id="dailyCarbs" placeholder="例如：300">
                        </div>
                        <div class="input-item">
                            <label class="input-label">蛋白质总量 (克)</label>
                            <input type="number" class="input-field" id="dailyProtein" placeholder="例如：120">
                        </div>
                    </div>
                    <button class="calculate-btn" onclick="calculateMealTargets()">计算每餐目标</button>
                </div>

                <div class="meals-grid" id="mealsGrid" style="display: none;">
                    <!-- 早餐 -->
                    <div class="meal-card">
                        <h3 class="meal-title">🌅 早餐</h3>
                        <div class="meal-targets" id="breakfast-targets">
                            <div class="target-item">
                                <span class="target-label">碳水化合物:</span>
                                <span class="target-value" id="breakfast-carbs">0g</span>
                            </div>
                            <div class="target-item">
                                <span class="target-label">蛋白质:</span>
                                <span class="target-value" id="breakfast-protein">0g</span>
                            </div>
                        </div>
                        <div class="food-selector">
                            <select class="food-select" id="breakfast-food-select">
                                <option value="">选择食物</option>
                            </select>
                            <button class="add-food-btn" onclick="addFoodToMeal('breakfast')">添加食物</button>
                        </div>
                        <div class="selected-foods" id="breakfast-foods"></div>
                        <div class="nutrition-summary" id="breakfast-summary">
                            <div class="summary-item">
                                <span>当前碳水:</span>
                                <span id="breakfast-current-carbs">0g</span>
                            </div>
                            <div class="summary-item">
                                <span>当前蛋白质:</span>
                                <span id="breakfast-current-protein">0g</span>
                            </div>
                        </div>
                    </div>

                    <!-- 午餐 -->
                    <div class="meal-card">
                        <h3 class="meal-title">🌞 午餐</h3>
                        <div class="meal-targets" id="lunch-targets">
                            <div class="target-item">
                                <span class="target-label">碳水化合物:</span>
                                <span class="target-value" id="lunch-carbs">0g</span>
                            </div>
                            <div class="target-item">
                                <span class="target-label">蛋白质:</span>
                                <span class="target-value" id="lunch-protein">0g</span>
                            </div>
                        </div>
                        <div class="food-selector">
                            <select class="food-select" id="lunch-food-select">
                                <option value="">选择食物</option>
                            </select>
                            <button class="add-food-btn" onclick="addFoodToMeal('lunch')">添加食物</button>
                        </div>
                        <div class="selected-foods" id="lunch-foods"></div>
                        <div class="nutrition-summary" id="lunch-summary">
                            <div class="summary-item">
                                <span>当前碳水:</span>
                                <span id="lunch-current-carbs">0g</span>
                            </div>
                            <div class="summary-item">
                                <span>当前蛋白质:</span>
                                <span id="lunch-current-protein">0g</span>
                            </div>
                        </div>
                    </div>

                    <!-- 晚餐 -->
                    <div class="meal-card">
                        <h3 class="meal-title">🌙 晚餐</h3>
                        <div class="meal-targets" id="dinner-targets">
                            <div class="target-item">
                                <span class="target-label">碳水化合物:</span>
                                <span class="target-value" id="dinner-carbs">0g</span>
                            </div>
                            <div class="target-item">
                                <span class="target-label">蛋白质:</span>
                                <span class="target-value" id="dinner-protein">0g</span>
                            </div>
                        </div>
                        <div class="food-selector">
                            <select class="food-select" id="dinner-food-select">
                                <option value="">选择食物</option>
                            </select>
                            <button class="add-food-btn" onclick="addFoodToMeal('dinner')">添加食物</button>
                        </div>
                        <div class="selected-foods" id="dinner-foods"></div>
                        <div class="nutrition-summary" id="dinner-summary">
                            <div class="summary-item">
                                <span>当前碳水:</span>
                                <span id="dinner-current-carbs">0g</span>
                            </div>
                            <div class="summary-item">
                                <span>当前蛋白质:</span>
                                <span id="dinner-current-protein">0g</span>
                            </div>
                        </div>
                    </div>

                    <!-- 零食/夜宵 -->
                    <div class="meal-card">
                        <h3 class="meal-title">🍪 零食/夜宵</h3>
                        <div class="meal-targets" id="snack-targets">
                            <div class="target-item">
                                <span class="target-label">碳水化合物:</span>
                                <span class="target-value" id="snack-carbs">0g</span>
                            </div>
                            <div class="target-item">
                                <span class="target-label">蛋白质:</span>
                                <span class="target-value" id="snack-protein">0g</span>
                            </div>
                        </div>
                        <div class="food-selector">
                            <select class="food-select" id="snack-food-select">
                                <option value="">选择食物</option>
                            </select>
                            <button class="add-food-btn" onclick="addFoodToMeal('snack')">添加食物</button>
                        </div>
                        <div class="selected-foods" id="snack-foods"></div>
                        <div class="nutrition-summary" id="snack-summary">
                            <div class="summary-item">
                                <span>当前碳水:</span>
                                <span id="snack-current-carbs">0g</span>
                            </div>
                            <div class="summary-item">
                                <span>当前蛋白质:</span>
                                <span id="snack-current-protein">0g</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 热量计算器页面 -->
        <div class="page-content" id="calorie-page">
            <div class="header">
                <h1>NutriFlow</h1>
                <p>智能营养助手 - 热量计算器</p>
            </div>
            
            <div class="calorie-calculator">
                <div class="user-info-section">
                    <h3 style="margin-bottom: 20px; color: #1e293b;">基本信息</h3>
                    <div class="info-grid">
                        <div class="info-group">
                            <label class="input-label">性别</label>
                            <select class="input-field" id="gender">
                                <option value="">请选择</option>
                                <option value="male">男性</option>
                                <option value="female">女性</option>
                            </select>
                        </div>
                        <div class="info-group">
                            <label class="input-label">年龄</label>
                            <input type="number" class="input-field" id="age" placeholder="例如：25">
                        </div>
                        <div class="info-group">
                            <label class="input-label">身高 (cm)</label>
                            <input type="number" class="input-field" id="height" placeholder="例如：170">
                        </div>
                        <div class="info-group">
                            <label class="input-label">体重 (kg)</label>
                            <input type="number" class="input-field" id="weight" placeholder="例如：70">
                        </div>
                        <div class="info-group">
                            <label class="input-label">目标</label>
                            <select class="input-field" id="goal">
                                <option value="">请选择</option>
                                <option value="bulk">增肌</option>
                                <option value="cut-no-training">减脂（无力量训练）</option>
                                <option value="cut-with-training">减脂（有力量训练）</option>
                            </select>
                        </div>
                        <div class="info-group">
                            <label class="input-label">有氧训练消耗 (大卡/天)</label>
                            <input type="number" class="input-field" id="cardioConsumption" placeholder="例如：200" value="0">
                            <small style="color: #64748b; font-size: 12px; margin-top: 4px;">根据有氧运动强度和时长估算</small>
                        </div>
                        <div class="info-group">
                            <label class="input-label">力量训练水平</label>
                            <select class="input-field" id="strengthLevel">
                                <option value="">请选择力量训练水平</option>
                                <option value="beginner">新手</option>
                                <option value="intermediate">有基础</option>
                                <option value="advanced">老手</option>
                            </select>
                            <small style="color: #64748b; font-size: 12px; margin-top: 4px;">仅对有力量训练的目标有效</small>
                        </div>
                    </div>
                    <button class="calculate-btn" onclick="calculateCalories()" style="margin-top: 20px;">计算热量需求</button>
                </div>

                <div class="results-section" id="calorieResults" style="display: none;">
                    <div class="results-grid">
                        <div class="result-card">
                            <h3>BMI指数</h3>
                            <div class="result-value" id="bmiValue">0</div>
                            <div class="result-status" id="bmiStatus">-</div>
                        </div>
                        <div class="result-card">
                            <h3>基础代谢</h3>
                            <div class="result-value" id="bmrValue">0</div>
                            <div class="result-unit">大卡/天</div>
                        </div>
                    </div>

                    <div class="calorie-breakdown" id="calorieBreakdown">
                        <!-- 热量分解详情将在这里显示 -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let nutritionData = [
            {category: "米类主食", food: "生米", carbohydrate: "75%", gi: "高", description: "大米、糙米、糯米、小米、黑米、紫米等不分品种均是"},
            {category: "米类主食", food: "米饭（很软）", carbohydrate: "25%", gi: "高", description: "只有自己做饭才可能这么软，外食几乎不可能"},
            {category: "米类主食", food: "米饭（一般）", carbohydrate: "30%", gi: "高", description: "外食的一般米饭，长方形的标准外卖盒一般100-120g碳水/盒"},
            {category: "米类主食", food: "米饭（偏硬）", carbohydrate: "35%", gi: "高", description: "外食的一般米饭，长方形的标准外卖盒一般100-120g碳水/盒"},
            {category: "米类主食", food: "米粥（稀）", carbohydrate: "10%", gi: "高", description: "粘稠度类似小米粥的稀饭"},
            {category: "米类主食", food: "米粥（一般）", carbohydrate: "13%", gi: "高", description: "粘稠度比小米粥要稠的稀饭"},
            {category: "米类主食", food: "米线（熟）", carbohydrate: "33%", gi: "高", description: "米线饱腹感很低，外食一般不低于100g碳水/份"},
            {category: "米类主食", food: "米糊（生）", carbohydrate: "75%", gi: "高", description: '电商搜索"营养米粉"或"成人米粉"或"健身米糊"，不要买成昂贵的婴儿米粉'},
            {category: "米类主食", food: "肠粉（熟）", carbohydrate: "20%", gi: "高", description: "广东地方主食，一般50-70g碳水/份"},
            {category: "米类主食", food: "粽子", carbohydrate: "50%", gi: "高", description: "可吃白粽、豆沙粽，不吃肉粽，饱腹感很低，一般40-60g碳水/个"},
            
            {category: "麦类主食", food: "切片面包", carbohydrate: "50%", gi: "高", description: "普通切片面包的脂肪率低于8%（性质是碳水食物），花式面包脂肪率高于10%甚至15%（性质是轻度糖油混合物）"},
            {category: "麦类主食", food: "馒头/花卷/馍/馕", carbohydrate: "50%", gi: "高", description: ""},
            {category: "麦类主食", food: "挂面（生）", carbohydrate: "75%", gi: "中", description: "挂面是面条里少有的中等GI碳水，不建议用于练后餐"},
            {category: "麦类主食", food: "意面（生）", carbohydrate: "75%", gi: "低", description: "意面是面条里少有的低GI碳水，不能用于练后餐"},
            {category: "麦类主食", food: "鲜面（生）", carbohydrate: "60%", gi: "高", description: "鲜面，指现和现拉的未下锅的面条，含水量高于干面，因此碳水率稍低，外食一般不低于100g碳水/份"},
            {category: "麦类主食", food: "凉面（熟）", carbohydrate: "30%", gi: "高", description: ""},
            {category: "麦类主食", food: "粗面（熟）", carbohydrate: "30%", gi: "高", description: "粗面，指像凉面粗细的面条，吸水率比细面低一些，因此碳水率稍高一些，外食一般不低于100g碳水/份"},
            {category: "麦类主食", food: "意面（熟）", carbohydrate: "30%", gi: "低", description: "意面是面条里少有的低GI碳水，不能用于练后餐"},
            {category: "麦类主食", food: "细面（熟）", carbohydrate: "23%", gi: "高", description: "细面，指像挂面粗细的面条，吸水率比粗面高一些，因此碳水率稍低一些，外食一般不低于100g碳水/份"},
            {category: "麦类主食", food: "卷饼/烙饼/馕（熟）", carbohydrate: "50%", gi: "高", description: "面粉糊烤熟成饼状主食，各地域称呼不同，饱腹感很低，外食一般不低于100g碳水/份"},
            
            {category: "其他主食", food: "红薯（生/蒸煮）", carbohydrate: "18%", gi: "高", description: ""},
            {category: "其他主食", food: "红薯（烤）", carbohydrate: "23%", gi: "高", description: ""},
            {category: "其他主食", food: "土豆（生/蒸煮）", carbohydrate: "18%", gi: "中", description: ""},
            {category: "其他主食", food: "土豆（烤）", carbohydrate: "23%", gi: "高", description: ""},
            {category: "其他主食", food: "红薯/土豆粉丝（生）", carbohydrate: "84%", gi: "低", description: "晒干制成的粉丝是少有的低GI碳水，例如酸辣粉、红薯粉、土豆粉，但注意米粉米线等新鲜食品不属于此类"},
            {category: "其他主食", food: "甜玉米（生/蒸煮）", carbohydrate: "20%", gi: "中", description: '甜玉米，指传统玉米，碳水率和GI比糯玉米低不少，不建议用于练后餐，电商关键词"笨玉米"、"老式玉米"'},
            {category: "其他主食", food: "糯玉米（生/蒸煮）", carbohydrate: "35%", gi: "高", description: '糯玉米，口味软糯，香味很重，碳水率和GI比甜玉米高得多，电商关键词"糯玉米"'},
            {category: "其他主食", food: "贝贝南瓜", carbohydrate: "21%", gi: "中", description: "注意贝贝南瓜和传统南瓜的碳水率差别极大"},
            {category: "其他主食", food: "传统南瓜", carbohydrate: "5%", gi: "中", description: "注意贝贝南瓜和传统南瓜的碳水率差别极大"},
            {category: "其他主食", food: "山药（生/蒸煮）", carbohydrate: "12%", gi: "中", description: ""},
            {category: "其他主食", food: "藕粉（生）", carbohydrate: "90%", gi: "低", description: "少有的低GI碳水，不要用于练后碳水，必须用开水冲调，冷却费时"},
            {category: "其他主食", food: "燕麦麸皮（生）", carbohydrate: "45%", gi: "低", description: "少有的低GI碳水，不要用于练后碳水；饱腹感极强；极高膳食纤维"},
            {category: "其他主食", food: "速食燕麦片（生）", carbohydrate: "60%", gi: "高", description: "饱腹感极强，一般不用于练后碳水以免太撑；极高膳食纤维"},
            {category: "其他主食", food: "速食黑麦片（生）", carbohydrate: "60%", gi: "高", description: "饱腹感极强，一般不用于练后碳水以免太撑；脂肪率比燕麦片低不少，是很纯净的碳水；极高膳食纤维"},
            
            {category: "方便食品", food: "五谷道场方便面", carbohydrate: "65%", gi: "中", description: "碳水约50g/袋或盒，虽然料包有油，但面饼非油炸，所以是碳水食物；高钠，建议粉包减半"},
            {category: "方便食品", food: "辛拉面（普通版）", carbohydrate: "65%", gi: "中", description: "碳水约50g/袋或盒，虽然面饼油炸，但调料包无油，所以接近于碳水食物；高钠，建议粉包减半"},
            {category: "方便食品", food: "辛拉面（空空面版）", carbohydrate: "65%", gi: "中", description: "碳水约50g/袋或盒，调料包无油，面饼非油炸，所以是彻底的碳水食物；高钠，建议粉包减半"},
            {category: "方便食品", food: "康力快熟意大利面", carbohydrate: "32%", gi: "低", description: "碳水约60g/袋，需另购意大利面酱料，注意意面是少有的低GI碳水，不要用于练后碳水"},
            {category: "方便食品", food: "白家陈记酸辣粉丝", carbohydrate: "60%", gi: "低", description: "碳水约40g/袋 60g/盒，料包只有几克油，所以是碳水食物；低GI，不用于练后碳水；高钠，建议粉包减半"},
            
            {category: "便携碳水", food: "切片面包", carbohydrate: "50%", gi: "高", description: "常规切片面包的脂肪率低于8%（碳水食物），花式面包脂肪率高于15%（轻度的糖油混合物）"},
            {category: "便携碳水", food: "旺仔小馒头（46g装）", carbohydrate: "88%", gi: "高", description: "碳水37g/袋，便于配餐，但约有1/4是蔗糖，不宜经常作为练后餐（可能导致果糖摄入超标）"},
            {category: "便携碳水", food: "旺仔QQ糖", carbohydrate: "72%", gi: "高", description: "小包装是20g装，碳水15g/袋；大包装是70g装，碳水50g/袋"},
            {category: "便携碳水", food: "十月稻田饭团", carbohydrate: "25%", gi: "高", description: '搜索"十月稻田糙米饭团"，碳水25g/袋，开袋即食'},
            {category: "便携碳水", food: "红螺牌驴打滚", carbohydrate: "86%", gi: "高", description: '搜索"红螺驴打滚"，碳水10g/小袋，此品牌甜味剂是用的麦芽糖而非蔗糖/果葡糖浆，不会产生果糖超标问题'},
            {category: "便携碳水", food: "山西烤馍", carbohydrate: "70%", gi: "高", description: '搜索"山西纯碱烤馍"，大袋装但保质期很长，口味类似葱香饼干'},
            {category: "便携碳水", food: "非油炸干脆面", carbohydrate: "75%", gi: "中", description: '搜索"豫派非油炸干脆面"，碳水27g/袋，口味类似小浣熊等油炸干脆面'},
            {category: "便携碳水", food: "BHB熟板栗", carbohydrate: "35%", gi: "中", description: '搜索"BHB板栗"，碳水35g/袋'},
            {category: "便携碳水", food: "沈大成豆沙青团", carbohydrate: "65%", gi: "高", description: '搜索"沈大成豆沙青团"，碳水45g/个，注意只能是豆沙味的，其他口味脂肪太高'},
            {category: "便携碳水", food: "云片糕/桃片", carbohydrate: "80%", gi: "高", description: "一般是小袋装，自己看包装重量，蔗糖率约10%，不致于导致果糖摄入超标"},
            {category: "便携碳水", food: "米花糖", carbohydrate: "85%", gi: "高", description: "一般都小袋装，自己看包装重量，蔗糖率约10%，不致于导致果糖摄入超标"},
            {category: "便携碳水", food: "娃哈哈八宝粥", carbohydrate: "13%", gi: "高", description: '搜索"娃哈哈八宝粥"，碳水47g/罐'},
            {category: "便携碳水", food: "宝矿力运动饮料", carbohydrate: "6%", gi: "中", description: "30g蔗糖/瓶，不能作为练后全部碳水，升血糖和胰岛素能力较弱，且可能导致果糖摄入超标"},
            {category: "便携碳水", food: "脉动运动饮料", carbohydrate: "5%", gi: "中", description: "30g蔗糖/瓶，不能作为练后全部碳水，升血糖和胰岛素能力较弱，且可能导致果糖摄入超标"},
            
            {category: "水果", food: "干枣", carbohydrate: "50%", gi: "中", description: ""},
            {category: "水果", food: "鲜枣", carbohydrate: "30%", gi: "中", description: ""},
            {category: "水果", food: "椰肉", carbohydrate: "30%", gi: "中", description: ""},
            {category: "水果", food: "榴莲", carbohydrate: "28%", gi: "中", description: ""},
            {category: "水果", food: "菠萝蜜", carbohydrate: "26%", gi: "中", description: ""},
            {category: "水果", food: "香蕉", carbohydrate: "22%", gi: "中", description: ""},
            {category: "水果", food: "提子", carbohydrate: "17%", gi: "中", description: ""},
            {category: "水果", food: "荔枝", carbohydrate: "17%", gi: "中", description: ""},
            {category: "水果", food: "桂圆", carbohydrate: "17%", gi: "中", description: ""},
            {category: "水果", food: "猕猴桃", carbohydrate: "15%", gi: "中", description: ""},
            {category: "水果", food: "苹果", carbohydrate: "13%", gi: "低", description: ""},
            {category: "水果", food: "梨", carbohydrate: "13%", gi: "低", description: ""},
            {category: "水果", food: "车厘子", carbohydrate: "13%", gi: "低", description: ""},
            {category: "水果", food: "火龙果", carbohydrate: "13%", gi: "中", description: ""},
            {category: "水果", food: "芒果", carbohydrate: "13%", gi: "中", description: ""},
            {category: "水果", food: "桑葚", carbohydrate: "13%", gi: "低", description: ""},
            {category: "水果", food: "葡萄", carbohydrate: "12%", gi: "低", description: ""},
            {category: "水果", food: "橘子", carbohydrate: "12%", gi: "低", description: ""},
            {category: "水果", food: "橙子", carbohydrate: "11%", gi: "低", description: ""},
            {category: "水果", food: "桃", carbohydrate: "10%", gi: "低", description: ""},
            {category: "水果", food: "柚子", carbohydrate: "10%", gi: "低", description: ""},
            {category: "水果", food: "樱桃", carbohydrate: "10%", gi: "低", description: ""},
            {category: "水果", food: "西梅", carbohydrate: "10%", gi: "低", description: ""},
            {category: "水果", food: "枇杷", carbohydrate: "9%", gi: "低", description: ""},
            {category: "水果", food: "李子", carbohydrate: "9%", gi: "低", description: ""},
            {category: "水果", food: "杏", carbohydrate: "9%", gi: "低", description: ""},
            {category: "水果", food: "哈密瓜", carbohydrate: "8%", gi: "高", description: ""},
            {category: "水果", food: "西瓜", carbohydrate: "7%", gi: "高", description: ""},
            {category: "水果", food: "木瓜", carbohydrate: "7%", gi: "中", description: ""},
            {category: "水果", food: "圣女果（小番茄）", carbohydrate: "6%", gi: "低", description: ""},
            {category: "水果", food: "西红柿（大番茄）", carbohydrate: "3%", gi: "低", description: ""},
            
            {category: "干净蛋白质", food: "瘦肉（鱼虾生肉）", carbohydrate: "15%", gi: "", description: "一般鱼虾的含水率高于家禽家畜，因此蛋白质率稍低"},
            {category: "干净蛋白质", food: "瘦肉（三文鱼/金枪鱼）", carbohydrate: "20%", gi: "", description: "三文鱼/金枪鱼本身脂肪率较高，并非瘦肉；但如果是吃中腩或赤身，且是无油生食，则也可视为瘦肉性质"},
            {category: "干净蛋白质", food: "瘦肉（家禽家畜生肉）", carbohydrate: "20%", gi: "", description: "没有白色脂肪层的猪牛羊肉，去皮的鸡鸭肉，才是瘦肉性质"},
            {category: "干净蛋白质", food: "瘦肉（一般的熟肉）", carbohydrate: "25%", gi: "", description: "鱼虾和家禽家畜瘦肉均属之，不用区分品种（鱼虾因为含水率更高，熟后脱水率更高，蛋白质率会显著上升）"},
            {category: "干净蛋白质", food: "瘦肉（柴感的熟肉）", carbohydrate: "30%", gi: "", description: "酱牛肉、干柴的卤肉等，因为脱水率更高，蛋白质率继续升高"},
            {category: "干净蛋白质", food: "瘦肉干", carbohydrate: "40%", gi: "", description: "牛肉干、鸡肉干，因为脱水率很高，蛋白质率就很高，建议碳水率（糖率）低于10%，好吃的肉干一般高于30%"},
            {category: "干净蛋白质", food: "蛋白粉", carbohydrate: "75%", gi: "", description: "乳清蛋白粉的一般70-80%，分离乳清蛋白粉一般80-90%，素食者可用大豆分离蛋白粉（氨基酸比例良好）"},
            
            {category: "含有蛋白质的混合物", food: "鸡蛋", carbohydrate: "6g/个", gi: "", description: "蛋清（蛋白质3g 脂肪0g）+蛋黄（蛋白质3g 脂肪5g）=全蛋（蛋白质6g 脂肪5g）"},
            {category: "含有蛋白质的混合物", food: "牛奶", carbohydrate: "10g/250ml盒", gi: "", description: "250ml盒装纯牛奶（碳水12g 蛋白质10g 脂肪9g），可以简单记忆为碳蛋脂都是10g"},
            {category: "含有蛋白质的混合物", food: "酸奶", carbohydrate: "10g/200ml盒", gi: "", description: "代糖酸奶可简单等同于纯牛奶，特殊酸奶（含糖酸奶会多10g+糖，希腊酸奶近乎零脂）可参照营养表来计算"},
            {category: "含有蛋白质的混合物", food: "干黄豆", carbohydrate: "35%", gi: "", description: "碳水34% 蛋白质35% 脂肪16%，碰到了可以吃一些，但不能替代瘦肉，因为氨基酸比例较差，且附带过多脂肪"},
            {category: "含有蛋白质的混合物", food: "鲜黄豆/毛豆/青豆", carbohydrate: "13%", gi: "", description: "碳水11% 蛋白质13% 脂肪5%，碰到了可以吃一些，但不能替代瘦肉，因为氨基酸比例较差，且附带过多脂肪"},
            {category: "含有蛋白质的混合物", food: "豆皮/千张", carbohydrate: "35%", gi: "", description: "碳水20% 蛋白质35% 脂肪20%，碰到了可以吃一些，但不能替代瘦肉，因为氨基酸比例较差，且附带过多脂肪"},
            {category: "含有蛋白质的混合物", food: "豆腐", carbohydrate: "7%", gi: "", description: "碳水3% 蛋白质7% 脂肪5%，碰到了可以吃一些，但不能替代瘦肉，因为氨基酸比例较差，且附带过多脂肪"},
            {category: "含有蛋白质的混合物", food: "豆浆", carbohydrate: "3%", gi: "", description: "碳水1% 蛋白质3% 脂肪2%，热量很低，可忽略不计，但肯麦等快餐店的高甜豆浆约放了20g糖，其实是一杯糖水"}
        ];
        let currentCategory = 'all';
        let searchQuery = '';
        let mealPlans = {
            breakfast: { foods: [], targetCarbs: 0, targetProtein: 0 },
            lunch: { foods: [], targetCarbs: 0, targetProtein: 0 },
            dinner: { foods: [], targetCarbs: 0, targetProtein: 0 },
            snack: { foods: [], targetCarbs: 0, targetProtein: 0 }
        };

        function initData() {
            const categories = [...new Set(nutritionData.map(item => item.category))];
            setupCategories(categories);
            renderNutritionCards();
            setupNavigation();
            populateFoodSelectors();
        }

        function setupNavigation() {
            const navBtns = document.querySelectorAll('.nav-btn');
            navBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const targetPage = btn.dataset.page;
                    switchPage(targetPage);
                    
                    navBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                });
            });
        }

        function switchPage(page) {
            const pages = document.querySelectorAll('.page-content');
            pages.forEach(p => p.classList.remove('active'));
            
            const targetPage = document.getElementById(page + '-page');
            if (targetPage) {
                targetPage.classList.add('active');
            }

            if (page === 'calculator') {
                document.querySelector('.meal-calculator').classList.add('active');
            }
        }

        function calculateMealTargets() {
            const dailyCarbs = parseFloat(document.getElementById('dailyCarbs').value);
            const dailyProtein = parseFloat(document.getElementById('dailyProtein').value);
            
            if (!dailyCarbs || !dailyProtein) {
                alert('请输入每日碳水化合物和蛋白质需求量');
                return;
            }

            const mealRatios = {
                breakfast: { carbs: 0.20, protein: 0.20 },
                lunch: { carbs: 0.35, protein: 0.30 },
                dinner: { carbs: 0.35, protein: 0.30 },
                snack: { carbs: 0.10, protein: 0.20 }
            };

            Object.keys(mealRatios).forEach(meal => {
                const carbsTarget = Math.round(dailyCarbs * mealRatios[meal].carbs);
                const proteinTarget = Math.round(dailyProtein * mealRatios[meal].protein);
                
                mealPlans[meal].targetCarbs = carbsTarget;
                mealPlans[meal].targetProtein = proteinTarget;
                
                document.getElementById(`${meal}-carbs`).textContent = `${carbsTarget}g`;
                document.getElementById(`${meal}-protein`).textContent = `${proteinTarget}g`;
            });

            document.getElementById('mealsGrid').style.display = 'grid';
        }

        function populateFoodSelectors() {
            const meals = ['breakfast', 'lunch', 'dinner', 'snack'];
            meals.forEach(meal => {
                const select = document.getElementById(`${meal}-food-select`);
                select.innerHTML = '<option value="">选择食物</option>';
                
                nutritionData.forEach((food, index) => {
                    const option = document.createElement('option');
                    option.value = index;
                    option.textContent = `${food.food} (${food.category})`;
                    select.appendChild(option);
                });
            });
        }

        function addFoodToMeal(mealType) {
            const selectId = `${mealType}-food-select`;
            const select = document.getElementById(selectId);
            const foodIndex = parseInt(select.value);
            
            if (isNaN(foodIndex)) {
                alert('请选择一个食物');
                return;
            }

            const food = nutritionData[foodIndex];
            const targetCarbs = mealPlans[mealType].targetCarbs;
            const targetProtein = mealPlans[mealType].targetProtein;
            
            let weight = calculateFoodWeight(food, targetCarbs, targetProtein);
            
            if (weight > 0) {
                const foodItem = {
                    ...food,
                    weight: weight,
                    actualCarbs: calculateNutrient(food.carbohydrate, weight),
                    actualProtein: calculateNutrient(food.carbohydrate, weight, food.category === '干净蛋白质' || food.category === '含有蛋白质的混合物')
                };
                
                mealPlans[mealType].foods.push(foodItem);
                renderMealFoods(mealType);
                updateMealSummary(mealType);
                select.value = '';
            }
        }

        function calculateFoodWeight(food, targetCarbs, targetProtein) {
            const isProteinFood = food.category === '干净蛋白质' || food.category === '含有蛋白质的混合物';
            let rate = parseFloat(food.carbohydrate.replace('%', '').replace('g/', '').replace('g/个', '').replace('g/250ml盒', '').replace('g/200ml盒', ''));
            
            if (isNaN(rate)) return 100;
            
            let weight;
            if (isProteinFood) {
                if (food.carbohydrate.includes('g/')) {
                    weight = (targetProtein / rate) * (food.carbohydrate.includes('个') ? 1 : 100);
                } else {
                    weight = (targetProtein / rate) * 100;
                }
            } else {
                weight = (targetCarbs / rate) * 100;
            }
            
            return Math.round(weight);
        }

        function calculateNutrient(value, weight, isProtein = false) {
            let rate = parseFloat(value.replace('%', '').replace('g/', '').replace('g/个', '').replace('g/250ml盒', '').replace('g/200ml盒', ''));
            
            if (isNaN(rate)) return 0;
            
            if (value.includes('g/')) {
                if (value.includes('个')) {
                    return Math.round((rate * weight));
                } else {
                    return Math.round((rate * weight) / 100);
                }
            } else {
                return Math.round((rate * weight) / 100);
            }
        }

        function renderMealFoods(mealType) {
            const container = document.getElementById(`${mealType}-foods`);
            const foods = mealPlans[mealType].foods;
            
            container.innerHTML = foods.map((food, index) => `
                <div class="selected-food-item">
                    <div>
                        <strong>${food.food}</strong><br>
                        <span class="food-weight">${food.weight}g</span>
                    </div>
                    <button class="remove-food" onclick="removeFoodFromMeal('${mealType}', ${index})">删除</button>
                </div>
            `).join('');
        }

        function removeFoodFromMeal(mealType, index) {
            mealPlans[mealType].foods.splice(index, 1);
            renderMealFoods(mealType);
            updateMealSummary(mealType);
        }

        function updateMealSummary(mealType) {
            const foods = mealPlans[mealType].foods;
            let totalCarbs = 0;
            let totalProtein = 0;
            
            foods.forEach(food => {
                const isProteinFood = food.category === '干净蛋白质' || food.category === '含有蛋白质的混合物';
                
                if (isProteinFood) {
                    totalProtein += calculateNutrient(food.carbohydrate, food.weight);
                    if (food.category === '含有蛋白质的混合物') {
                        totalCarbs += calculateNutrient(food.carbohydrate, food.weight) * 0.1; // 估算碳水
                    }
                } else {
                    totalCarbs += calculateNutrient(food.carbohydrate, food.weight);
                }
            });
            
            document.getElementById(`${mealType}-current-carbs`).textContent = `${Math.round(totalCarbs)}g`;
            document.getElementById(`${mealType}-current-protein`).textContent = `${Math.round(totalProtein)}g`;
        }

        // 热量计算相关函数
        function calculateCalories() {
            const gender = document.getElementById('gender').value;
            const age = parseFloat(document.getElementById('age').value);
            const height = parseFloat(document.getElementById('height').value);
            const weight = parseFloat(document.getElementById('weight').value);
            const goal = document.getElementById('goal').value;
            const cardio = parseFloat(document.getElementById('cardioConsumption').value) || 0;
            const strengthLevel = document.getElementById('strengthLevel').value;

            if (!gender || !age || !height || !weight || !goal) {
                alert('请填写所有基本信息');
                return;
            }

            // 对于有力量训练的目标，检查是否选择了力训水平
            if ((goal === 'bulk' || goal === 'cut-with-training') && !strengthLevel) {
                alert('请选择力量训练水平');
                return;
            }

            // 计算BMI
            const bmi = calculateBMI(weight, height);
            const bmiStatus = getBMIStatus(bmi);
            
            // 计算基础代谢（使用修正的公式）
            const bmr = calculateBMR(gender, weight, height, age);

            // 显示结果
            document.getElementById('bmiValue').textContent = bmi.toFixed(1);
            document.getElementById('bmiStatus').textContent = bmiStatus;
            document.getElementById('bmrValue').textContent = Math.round(bmr);
            document.getElementById('calorieResults').style.display = 'block';

            // 隐藏所有详细输入区域
            // hideAllDetailedInputs();

            // 根据目标显示相应的热量计算
            if (goal === 'bulk') {
                showBulkCalculation(bmr, cardio, gender, strengthLevel);
            } else if (goal === 'cut-no-training') {
                showCutNoTrainingCalculation(bmr, cardio);
            } else if (goal === 'cut-with-training') {
                showCutWithTrainingCalculation(bmr, cardio, gender, strengthLevel);
            }
        }

        function getStrengthTrainingCalories(gender, level) {
            const maleCalories = { beginner: 150, intermediate: 200, advanced: 250 };
            const femaleCalories = { beginner: 100, intermediate: 150, advanced: 200 };
            
            return gender === 'male' ? maleCalories[level] : femaleCalories[level];
        }

        function calculateBMI(weight, height) {
            const heightInMeters = height / 100;
            return weight / (heightInMeters * heightInMeters);
        }

        function getBMIStatus(bmi) {
            if (bmi < 18.5) return '偏瘦';
            if (bmi < 24) return '正常';
            if (bmi < 28) return '超重';
            return '肥胖';
        }

        function calculateBMR(gender, weight, height, age) {
            if (gender === 'male') {
                return weight * 9.99 + height * 6.25 - age * 4.92 + 5;
            } else {
                return weight * 9.99 + height * 6.25 - age * 4.92 - 161;
            }
        }

        function hideAllDetailedInputs() {
            // 不再需要详细输入区域
        }

        function showBulkCalculation(bmr, cardio, gender, strengthLevel) {
            // 计算无运动总消耗和力训消耗
            const noExerciseTotal = Math.round(bmr / 0.7);
            const strength = getStrengthTrainingCalories(gender, strengthLevel);
            
            // 增肌计算：平衡热量和应摄入热量
            const balanceTrainingDay = noExerciseTotal + cardio + strength;
            const balanceRestDay = noExerciseTotal + cardio;
            const intakeTrainingDay = Math.round(balanceTrainingDay * 0.84);
            const intakeRestDay = Math.round(balanceRestDay * 0.84);

            showBreakdown('增肌热量分配', [
                { label: '基础代谢', value: Math.round(bmr) },
                { label: '无运动总消耗', value: noExerciseTotal },
                { label: '有氧训练消耗', value: cardio },
                { label: '力量训练消耗', value: strength },
                { label: '平衡热量（力训日）', value: balanceTrainingDay },
                { label: '平衡热量（休息日）', value: balanceRestDay },
                { label: '应摄入热量（力训日）', value: intakeTrainingDay, isIntake: true },
                { label: '应摄入热量（休息日）', value: intakeRestDay, isIntake: true }
            ]);
        }

        function showCutNoTrainingCalculation(bmr, cardio) {
            // 减脂无力量训练
            const noExerciseTotal = Math.round(bmr / 0.7);
            const balanceCalories = noExerciseTotal + cardio;
            const intakeCalories = Math.round(balanceCalories * 0.64);

            showBreakdown('减脂热量分配（无力量训练）', [
                { label: '基础代谢', value: Math.round(bmr) },
                { label: '无运动总消耗', value: noExerciseTotal },
                { label: '有氧训练消耗', value: cardio },
                { label: '平衡热量', value: balanceCalories },
                { label: '应摄入热量', value: intakeCalories, isIntake: true }
            ]);
        }

        function showCutWithTrainingCalculation(bmr, cardio, gender, strengthLevel) {
            // 计算无运动总消耗和力训消耗
            const noExerciseTotal = Math.round(bmr / 0.7);
            const strength = getStrengthTrainingCalories(gender, strengthLevel);
            
            // 减脂有力训计算：平衡热量和应摄入热量
            const balanceTrainingDay = noExerciseTotal + cardio + strength;
            const balanceRestDay = noExerciseTotal + cardio;
            const intakeTrainingDay = Math.round(balanceTrainingDay * 0.64);
            const intakeRestDay = Math.round(balanceRestDay * 0.64);

            showBreakdown('减脂热量分配（有力量训练）', [
                { label: '基础代谢', value: Math.round(bmr) },
                { label: '无运动总消耗', value: noExerciseTotal },
                { label: '有氧训练消耗', value: cardio },
                { label: '力量训练消耗', value: strength },
                { label: '平衡热量（力训日）', value: balanceTrainingDay },
                { label: '平衡热量（休息日）', value: balanceRestDay },
                { label: '应摄入热量（力训日）', value: intakeTrainingDay, isIntake: true },
                { label: '应摄入热量（休息日）', value: intakeRestDay, isIntake: true }
            ]);
        }

        function showBreakdown(title, items) {
            let html = `<div class="breakdown-title">${title}</div>`;
            
            items.forEach(item => {
                const isIntake = item.isIntake;
                const itemClass = isIntake ? 'intake' : '';
                html += `
                    <div class="breakdown-item ${itemClass}">
                        <span class="breakdown-label">${item.label}</span>
                        <span class="breakdown-value">${item.value}大卡</span>
                    </div>
                `;
            });

            document.getElementById('calorieBreakdown').innerHTML = html;
        }

        function calculateDetailedCalories() {
            // 不再需要详细输入重新计算功能
        }

        function calculateCutWithTraining() {
            // 不再需要详细输入重新计算功能
        }

        function setupCategories(categories) {
            const categoryTabs = document.getElementById('categoryTabs');
            const allButton = categoryTabs.querySelector('[data-category="all"]');
            
            categories.forEach(category => {
                const button = document.createElement('button');
                button.className = 'category-tab';
                button.dataset.category = category;
                button.textContent = category;
                button.addEventListener('click', () => filterByCategory(category, button));
                categoryTabs.appendChild(button);
            });
            
            allButton.addEventListener('click', () => filterByCategory('all', allButton));
        }

        function filterByCategory(category, button) {
            currentCategory = category;
            document.querySelectorAll('.category-tab').forEach(tab => tab.classList.remove('active'));
            button.classList.add('active');
            renderNutritionCards();
        }

        function filterData() {
            return nutritionData.filter(item => {
                const matchesCategory = currentCategory === 'all' || item.category === currentCategory;
                const matchesSearch = searchQuery === '' || 
                    item.food.toLowerCase().includes(searchQuery.toLowerCase()) ||
                    item.category.toLowerCase().includes(searchQuery.toLowerCase());
                return matchesCategory && matchesSearch;
            });
        }

        function renderNutritionCards() {
            const container = document.getElementById('nutritionContainer');
            const filteredData = filterData();
            
            if (filteredData.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="8" x2="12" y2="12"></line>
                            <line x1="12" y1="16" x2="12.01" y2="16"></line>
                        </svg>
                        <h3>暂无数据</h3>
                        <p>没有找到匹配的食物信息</p>
                    </div>
                `;
                return;
            }
            
            const groupedData = {};
            filteredData.forEach(item => {
                if (!groupedData[item.category]) {
                    groupedData[item.category] = [];
                }
                groupedData[item.category].push(item);
            });
            
            let html = '';
            Object.keys(groupedData).forEach(category => {
                if (currentCategory === 'all') {
                    html += `<div class="category-section">
                        <h2 class="category-title">${category}</h2>`;
                }
                
                html += `<table class="nutrition-table">
                    <thead>
                        <tr>
                            <th>分类</th>
                            <th>食物名称</th>
                            <th>${category === '蛋白质' ? '蛋白质含量' : '碳水化合物'}</th>
                            <th>GI指数</th>
                            <th>详细说明</th>
                        </tr>
                    </thead>
                    <tbody>`;
                
                groupedData[category].forEach(item => {
                    html += `
                        <tr>
                            <td class="category-cell">${item.category}</td>
                            <td class="food-name-cell">${item.food}</td>
                            <td class="carb-rate-cell">${item.carbohydrate}</td>
                            <td class="gi-cell">
                                ${item.gi ? `<span class="gi-badge gi-${item.gi}">${item.gi}</span>` : '-'}
                            </td>
                            <td class="description-cell">
                                ${item.description ? item.description.replace(/\n/g, '<br>') : '-'}
                            </td>
                        </tr>
                    `;
                });
                
                html += '</tbody></table>';
                
                if (currentCategory === 'all') {
                    html += '</div>';
                }
            });
            
            container.innerHTML = html;
        }

        document.getElementById('searchInput').addEventListener('input', (e) => {
            searchQuery = e.target.value;
            renderNutritionCards();
        });

        initData();
    </script>
</body>
</html>